<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Sherry J" />

<meta name="date" content="2020-01-03" />

<title>Introduction to SC19084</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Introduction to SC19084</h1>
<h4 class="author">Sherry J</h4>
<h4 class="date">2020-01-03</h4>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p><strong>SC19084</strong> is a simple R package developed to compare the performance of two methods under circumstance of high dimensional regression. Two functions are considered, namely, <em>ol1</em> (min_beta (2 Lam)^(-1) (z - beta)^2 + p_lambda(|beta|) for L1 penalty) and <em>uhard</em> (min_beta (2 Lam)^(-1) (z - beta)^2 + lambda0 |beta| + p_lambda(|beta|) for hard-thresholding penalty).</p>
<p>For ol1 function, we are able to estimate coefficient vector beta for L1 penalty and the uhard function was constructed to implement the high dimensional threshold regression.</p>
</div>
<div id="ol1-function" class="section level2">
<h2>ol1 function</h2>
<p>To use this function, error and design matrix are required to be generated according to some rules.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(SC19084)
<span class="kw">set.seed</span>(<span class="dv">123</span>)
n&lt;-<span class="dv">10</span>;p&lt;-<span class="dv">15</span>
b0&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,p,<span class="dv">1</span>)
b0[<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>]&lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">0.7</span>,<span class="op">-</span><span class="fl">1.2</span>,<span class="op">-</span><span class="fl">0.9</span>,<span class="fl">0.3</span>,<span class="fl">0.55</span>)
epsi &lt;-<span class="fl">0.01</span>
cormat=<span class="kw">matrix</span>(<span class="dv">1</span>,p,p)
corval =<span class="st"> </span><span class="fl">0.5</span>
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(p<span class="op">-</span><span class="dv">1</span>)){
  <span class="cf">for</span> (j <span class="cf">in</span> (i<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>p){
    cormat[i,j]=corval<span class="op">^</span><span class="kw">abs</span>(i<span class="op">-</span>j)
    cormat[j,i]=cormat[i,j]
 }
}
sigmat=cormat<span class="op">^</span><span class="fl">0.5</span>
X&lt;-<span class="kw">matrix</span>(<span class="kw">rnorm</span>(n<span class="op">*</span>p),n,p)<span class="op">%*%</span>sigmat
y&lt;-X<span class="op">%*%</span>b0<span class="op">+</span><span class="fl">0.4</span><span class="op">*</span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n),n,<span class="dv">1</span>)
Xsca &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">colSums</span>(X<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span><span class="kw">sqrt</span>(n)
X &lt;-<span class="st"> </span>X<span class="op">/</span>(<span class="kw">matrix</span>(<span class="dv">1</span>,n,<span class="dv">1</span>)<span class="op">%*%</span>Xsca)</code></pre></div>
<p>Then get the input parameters from what we generated above.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">XXmat &lt;-<span class="st"> </span>n<span class="op">^</span>(<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">t</span>(X)<span class="op">%*%</span>X
cvec &lt;-<span class="st"> </span>n<span class="op">^</span>(<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">t</span>(X)<span class="op">%*%</span>y
lammax =<span class="st"> </span><span class="kw">max</span>(<span class="kw">abs</span>(cvec))
lammin =<span class="st"> </span>epsi<span class="op">*</span>lammax
lamvec =<span class="st"> </span>lammax <span class="op">-</span><span class="st"> </span>(lammax <span class="op">-</span><span class="st"> </span>lammin)<span class="op">/</span>(<span class="dv">50</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)<span class="op">*</span><span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span>(<span class="dv">50</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span>))
inival&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,p)
lambda&lt;-lamvec[<span class="dv">50</span>]
varset&lt;-<span class="kw">vector</span>(<span class="dt">mode=</span><span class="st">&quot;numeric&quot;</span>)</code></pre></div>
<p>Obtain coefficient vector beta for L1 penalty regression.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ol1</span>(XXmat, cvec, inival, lambda, varset, <span class="dv">50</span>, <span class="fl">1e-4</span>)</code></pre></div>
<pre><code>##  [1]  0.805862482  0.368709880  0.000000000 -1.372003342 -0.674852680
##  [6] -0.021085513  0.568264254  0.180375295  0.060483024  0.003563566
## [11]  0.225423430 -0.174781204 -0.114024592  0.000000000  0.010162554</code></pre>
</div>
<div id="uhard-function" class="section level2">
<h2>uhard function</h2>
<p>As one step to realise ICA algorithm which is applyed to implement the high dimensional threshold regression, error and design matrix are also required to be generated.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">321</span>)
n&lt;-<span class="dv">10</span>;p&lt;-<span class="dv">15</span>
b0&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,p,<span class="dv">1</span>)
b0[<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>]&lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">0.7</span>,<span class="op">-</span><span class="fl">1.2</span>,<span class="op">-</span><span class="fl">0.9</span>,<span class="fl">0.3</span>,<span class="fl">0.55</span>)
epsi &lt;-<span class="fl">0.01</span>
cormat=<span class="kw">matrix</span>(<span class="dv">1</span>,p,p)
corval =<span class="st"> </span><span class="fl">0.5</span>
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(p<span class="op">-</span><span class="dv">1</span>)){
  <span class="cf">for</span> (j <span class="cf">in</span> (i<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>p){
    cormat[i,j]=corval<span class="op">^</span><span class="kw">abs</span>(i<span class="op">-</span>j)
    cormat[j,i]=cormat[i,j]
 }
}
sigmat=cormat<span class="op">^</span><span class="fl">0.5</span>
X&lt;-<span class="kw">matrix</span>(<span class="kw">rnorm</span>(n<span class="op">*</span>p),n,p)<span class="op">%*%</span>sigmat
y&lt;-X<span class="op">%*%</span>b0<span class="op">+</span><span class="fl">0.4</span><span class="op">*</span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n),n,<span class="dv">1</span>)
Xsca &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">colSums</span>(X<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span><span class="kw">sqrt</span>(n)
X &lt;-<span class="st"> </span>X<span class="op">/</span>(<span class="kw">matrix</span>(<span class="dv">1</span>,n,<span class="dv">1</span>)<span class="op">%*%</span>Xsca)</code></pre></div>
<p>Then get the input parameters from what we generated above.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">XXmat &lt;-<span class="st"> </span>n<span class="op">^</span>(<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">t</span>(X)<span class="op">%*%</span>X
z1 =<span class="st"> </span>XXmat[<span class="dv">1</span>, <span class="dv">1</span>]
Lam&lt;-<span class="dv">1</span><span class="op">/</span>z1
cvec &lt;-<span class="st"> </span>n<span class="op">^</span>(<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">t</span>(X)<span class="op">%*%</span>y
z&lt;-cvec[<span class="dv">1</span>]<span class="op">/</span>z1
lammax =<span class="st"> </span><span class="kw">max</span>(<span class="kw">abs</span>(cvec))
lammin =<span class="st"> </span>epsi<span class="op">*</span>lammax
lamvec =<span class="st"> </span>lammax <span class="op">-</span><span class="st"> </span>(lammax <span class="op">-</span><span class="st"> </span>lammin)<span class="op">/</span>(<span class="dv">50</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)<span class="op">*</span><span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span>(<span class="dv">50</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span>))
lambda0&lt;-lamvec[<span class="dv">49</span>]
lambda&lt;-lamvec[<span class="dv">50</span>]</code></pre></div>
<p>Obtain one number of coefficient vector beta.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">uhard</span>(z, Lam, lambda0, lambda)</code></pre></div>
<pre><code>## [1] -0.5302706</code></pre>
<p>Through this method, coefficient vector beta for hard-thresholding penalty regression shall be obtained.</p>
</div>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce at least 3 examples (texts, figures, tables).</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>Example 1</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#par(bg=&quot;ivory3&quot;)</span>
<span class="kw">set.seed</span>(<span class="dv">123</span>)
x=<span class="kw">rnorm</span>(<span class="dv">100</span>,<span class="dt">mean=</span><span class="dv">100</span>,<span class="dt">sd=</span><span class="dv">10</span>)
<span class="kw">hist</span>(x,<span class="dt">breaks=</span><span class="dv">20</span>,<span class="dt">col=</span><span class="dv">2</span>,<span class="dt">main=</span><span class="st">&quot;Simple Histogram&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>A rough situation of Gaussian distribution can be observed.</p>
<p>Example 2</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">A=<span class="kw">head</span>(freeny)
M=A[<span class="op">-</span><span class="dv">2</span>]
knitr<span class="op">::</span><span class="kw">kable</span>(M)</code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">y</th>
<th align="right">price.index</th>
<th align="right">income.level</th>
<th align="right">market.potential</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1962.25</td>
<td align="right">8.79236</td>
<td align="right">4.70997</td>
<td align="right">5.82110</td>
<td align="right">12.9699</td>
</tr>
<tr class="even">
<td>1962.5</td>
<td align="right">8.79137</td>
<td align="right">4.70217</td>
<td align="right">5.82558</td>
<td align="right">12.9733</td>
</tr>
<tr class="odd">
<td>1962.75</td>
<td align="right">8.81486</td>
<td align="right">4.68944</td>
<td align="right">5.83112</td>
<td align="right">12.9774</td>
</tr>
<tr class="even">
<td>1963</td>
<td align="right">8.81301</td>
<td align="right">4.68558</td>
<td align="right">5.84046</td>
<td align="right">12.9806</td>
</tr>
<tr class="odd">
<td>1963.25</td>
<td align="right">8.90751</td>
<td align="right">4.64019</td>
<td align="right">5.85036</td>
<td align="right">12.9831</td>
</tr>
<tr class="even">
<td>1963.5</td>
<td align="right">8.93673</td>
<td align="right">4.62553</td>
<td align="right">5.86464</td>
<td align="right">12.9854</td>
</tr>
</tbody>
</table>
<p>Example 3</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x=<span class="kw">rbinom</span>(<span class="dv">50</span>,<span class="dv">3000</span>,<span class="fl">0.001</span>)
y=<span class="kw">rpois</span>(<span class="dv">50</span>,<span class="dv">3</span>)
lm.cf=<span class="kw">lm</span>(x<span class="op">~</span>y)
<span class="kw">summary</span>(lm.cf)<span class="op">$</span>coef</code></pre></div>
<pre><code>##               Estimate Std. Error   t value     Pr(&gt;|t|)
## (Intercept)  3.5467942  0.4424535  8.016197 2.081484e-10
## y           -0.1714064  0.1324450 -1.294171 2.017986e-01</code></pre>
<p>The <span class="math inline">\(R^2\)</span> is 0.0337168</p>
<p>It shows the approximation between the poission distribution and the binomial distribution</p>
</div>
<div id="question-3.4" class="section level2">
<h2>Question 3.4</h2>
<p>The Rayleigh density [156, Ch. 18] is <span class="math display">\[
f(x)=\frac{x}{\sigma^{2}} e^{-x^{2} /\left(2 \sigma^{2}\right)}, \quad x \geq 0, \sigma&gt;0
\]</span> Develop an algorithm to generate random samples from a Rayleigh(??) distribution. Generate Rayleigh(??) samples for several choices of ?? &gt; 0 and check that the mode of the generated samples is close to the theoretical mode ??(check the histogram).</p>
</div>
<div id="answer-for-3.4" class="section level2">
<h2>Answer for 3.4</h2>
<p>First, we use the inverse transform method to generate random number with the distribution in the title.</p>
<p>Rayleigh distribution depend on the choice of ?? so that a function is developed as below. Attention, we can also check that the mode of the generated samples is close to the theoretical mode in the function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n&lt;-<span class="fl">1e4</span>
myrn&lt;-<span class="cf">function</span>(sigma){
u&lt;-<span class="kw">runif</span>(n)
x&lt;-(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>(sigma<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)
<span class="kw">hist</span>(x,<span class="dt">breaks=</span><span class="dv">15</span>, <span class="dt">prob =</span> <span class="ot">TRUE</span>,<span class="co">#main=expression(f(x)==x/sigma^2*exp(-(x^2)/(2*sigma^2))))</span>
      <span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&quot;sigma=&quot;</span>,sigma))
a &lt;-<span class="st"> </span><span class="kw">seq</span>(.<span class="dv">001</span>, <span class="dv">10</span>, .<span class="dv">001</span>);y&lt;-a<span class="op">/</span>(sigma<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>(a<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>))
<span class="kw">lines</span>(a, y)
}</code></pre></div>
<p>Then we generate Rayleigh samples for several choices of ?? and check that the mode of the generated samples is close to the theoretical mode by checking the histogram.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#par(mfrow=c(2,2))</span>
<span class="kw">myrn</span>(.<span class="dv">5</span>);<span class="kw">myrn</span>(<span class="dv">1</span>);<span class="kw">myrn</span>(<span class="dv">2</span>);<span class="kw">myrn</span>(<span class="dv">4</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can observe that the mode of the generated samples is close to the theoretical mode where <span class="math inline">\(\sigma\)</span>=0.5,1,2,4.</p>
</div>
<div id="wonder" class="section level1">
<h1>Wonder</h1>
<p>Is there any other intuitive method to check that the mode of the generated samples is close to the theoretical mode ?</p>
<div id="question-3.11" class="section level2">
<h2>Question 3.11</h2>
<p>Generate a random sample of size 1000 from a normal location mixture. The components of the mixture have <span class="math inline">\(N(0,1)\)</span> and <span class="math inline">\(N(3,1)\)</span> distributions with mixing probabilities <span class="math inline">\(p_{1}\)</span> and <span class="math inline">\(p_{2}=1-p_{1}\)</span> . Graph the histogram of the sample with density superimposend, for <span class="math inline">\(p_{1}\)</span> = 0.75. Repeat with different values for <span class="math inline">\(p_{1}\)</span> and observe whether the empirical distribution of the mixture appears to be bimodal. Make a conjecture about the values of <span class="math inline">\(p_{1}\)</span> that produce bimodal mixtures.</p>
</div>
<div id="answer-for-3.11" class="section level2">
<h2>Answer for 3.11</h2>
<p>Suppose <span class="math inline">\(X_{1} \sim N(0,1)\)</span> and <span class="math inline">\(X_{2} \sim N(3,1)\)</span> are independent.The notation <span class="math inline">\(Z=p_{1} X_{1}+p_{2} X_{2}\)</span> denotes the mixture of <span class="math inline">\(X_{1}\)</span> and <span class="math inline">\(X_{2}\)</span> .</p>
<p>To simulate the mixture:</p>
<ol style="list-style-type: decimal">
<li><p>Generate <span class="math inline">\(x_{1} \sim N(0,1)\)</span> and <span class="math inline">\(x_{2} \sim N(3,1)\)</span></p></li>
<li><p>Deliver <span class="math inline">\(z=p_{1} x_{1}+p_{2} x_{2}\)</span> for different values of <span class="math inline">\(p_{1}\)</span></p></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span><span class="fl">1e3</span>
x1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)
x2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)
myz&lt;-<span class="cf">function</span>(r){  <span class="co"># function to generate different z as value of p1 changes</span>
z &lt;-<span class="st"> </span>r<span class="op">*</span>x1<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>r)<span class="op">*</span>x2
<span class="kw">hist</span>(z,<span class="dt">breaks=</span><span class="dv">30</span>,<span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&quot;z=&quot;</span>,r,<span class="st">&quot;X1+&quot;</span>,(<span class="dv">1</span><span class="op">-</span>r),<span class="st">&quot;X2&quot;</span>))
}
<span class="co">#par(mfrow=c(2,2))</span>
<span class="kw">myz</span>(.<span class="dv">75</span>);<span class="kw">myz</span>(.<span class="dv">5</span>);<span class="kw">myz</span>(.<span class="dv">25</span>);<span class="kw">myz</span>(.<span class="dv">1</span>)<span class="co">#show histograms where p1=0,75,0.5,0.25,0.1</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>From figures above, we can observe the empirical distribution of the mixture appears to be unimodal when the value of <span class="math inline">\(p_{1}\)</span> take o.75,0.25 and 0.1, while appears to be bimodal for <span class="math inline">\(p_{1}\)</span>=0.5.</p>
<p>Thus, we Make a conjecture that the value of <span class="math inline">\(p_{1}\)</span> that produce bimodal mixture is 0.5.</p>
</div>
</div>
<div id="wonder-1" class="section level1">
<h1>Wonder</h1>
<p>What are the factors influence the distance of two peaks?</p>
<div id="question-3.18" class="section level2">
<h2>Question 3.18</h2>
<p>Write a function to generate a random sample from a <span class="math inline">\(W_{d}(\Sigma, n)\)</span> (Wishart) distribution for <span class="math inline">\(n&gt;d+1 \geq 1\)</span>, based on Bartlett??s decomposition.</p>
</div>
<div id="answer-for-3.18" class="section level2">
<h2>Answer for 3.18</h2>
<p>To generate a random sample from a <span class="math inline">\(W_{d}(\Sigma, n)\)</span> (Wishart) distribution based on Bartlett??s decomposition, we set <span class="math inline">\(\Sigma\)</span> a symmetric and positive <span class="math inline">\(d \times d\)</span> matrix as below <span class="math display">\[
\Sigma=\left(\begin{array}{ccc}{9} &amp; {18} &amp; {3} \\ {18} &amp; {40} &amp; {16} \\ {3} &amp; {16} &amp; {27}\end{array}\right)
\]</span> for a <span class="math inline">\(W_{3}(\Sigma, n)\)</span> (Wishart) distribution.</p>
<p><span class="math inline">\(T=\left(T_{i j}\right)\)</span> is a lower triangular <span class="math inline">\(d \times d\)</span> random matrix with independent entries satisfying</p>
<p><span class="math display">\[
\begin{array}{l}{\text { 1. } T_{i j} \stackrel{i i d}{\sim} N(0,1), i&gt;j} \\ {\text { 2. } T_{i i} \sim \sqrt{\chi^{2}(n-i+1)}, i=1, \ldots, d}\end{array}
\]</span></p>
<p>According to Bartlett??s decomposition, <span class="math inline">\(A=T T^{T}\)</span> has a <span class="math inline">\(W_{3}\left(I_{3}, n\right)\)</span> distribution. Also, we obtain the Choleski factorization <span class="math inline">\(\Sigma=L L^{T}\)</span> where <span class="math inline">\(L\)</span> is lower triangular. Finally we get <span class="math inline">\(X=L A L^{T}\)</span></p>
<p>On the basis of what we discussed above, a function is written to generate a random sample from a <span class="math inline">\(W_{3}(\Sigma, n)\)</span> (Wishart) distribution for any <span class="math inline">\(n\)</span> satisfying <span class="math inline">\(n&gt;d+1 \geq 1\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myW=<span class="cf">function</span>(n){
  sigma&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">9</span>,<span class="dv">18</span>,<span class="dv">3</span>,<span class="dv">18</span>,<span class="dv">40</span>,<span class="dv">16</span>,<span class="dv">2</span>,<span class="dv">16</span>,<span class="dv">27</span>),<span class="dv">3</span>,<span class="dv">3</span>)<span class="co">#set a three dimentional scale matrix sigma</span>
  a&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">9</span>);T&lt;-<span class="kw">matrix</span>(a,<span class="dv">3</span>,<span class="dv">3</span>)
  T[<span class="dv">1</span>,<span class="dv">1</span>]&lt;-<span class="kw">sqrt</span>(<span class="kw">rchisq</span>(<span class="dv">1</span>,n));T[<span class="dv">2</span>,<span class="dv">1</span>]&lt;-<span class="kw">rnorm</span>(<span class="dv">1</span>);T[<span class="dv">2</span>,<span class="dv">2</span>]&lt;-<span class="kw">sqrt</span>(<span class="kw">rchisq</span>(<span class="dv">1</span>,n<span class="op">-</span><span class="dv">1</span>))
  T[<span class="dv">3</span>,<span class="dv">1</span>]&lt;-<span class="kw">rnorm</span>(<span class="dv">1</span>);T[<span class="dv">3</span>,<span class="dv">2</span>]&lt;-<span class="kw">rnorm</span>(<span class="dv">1</span>);T[<span class="dv">3</span>,<span class="dv">3</span>]&lt;-<span class="kw">sqrt</span>(<span class="kw">rchisq</span>(<span class="dv">1</span>,n<span class="op">-</span><span class="dv">2</span>))<span class="co">#set matrix T</span>
  A&lt;-T<span class="op">%*%</span><span class="kw">t</span>(T) <span class="co">#obtain matrix A</span>
  L=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">3</span>,<span class="dv">3</span>)<span class="co">#show the Choleski factorization of sigma</span>
  X&lt;-L<span class="op">%*%</span>A<span class="op">%*%</span><span class="kw">t</span>(L) <span class="co"># obtain random sample X</span>
  X
}</code></pre></div>
<p>Now we generate a random sample from a <span class="math inline">\(W_{3}(\Sigma, 30)\)</span> (Wishart) distribution.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">myW</span>(<span class="dv">30</span>)</code></pre></div>
<pre><code>##           [,1]     [,2]      [,3]
## [1,] 163.09241 336.0530  79.22149
## [2,] 336.05295 771.2830 348.45615
## [3,]  79.22149 348.4561 502.24638</code></pre>
</div>
<div id="question-5.1" class="section level2">
<h2>Question <strong>5.1</strong></h2>
<p>Compute a Monte Carlo estimate of <span class="math display">\[
\int_{0}^{\pi / 3} \sin t d t
\]</span></p>
<p>and compare your estimate with the exact value of the integral.</p>
</div>
<div id="answer-for-5.1" class="section level2">
<h2>Answer for <strong>5.1</strong></h2>
<ul>
<li><h3 id="basic-idea">Basic idea</h3></li>
</ul>
<p>Represent the integral as the expected value of a function of a uniform random variable..</p>
<p><span class="math display">\[
\theta=\int_{0}^{\pi / 3} \sin t d t=\int_{0}^{\pi / 3} \frac{1}{\pi / 3} \cdot \frac{\pi}{3} \sin t d t=\frac{\pi}{3} E(\sin X) \triangleq E(g(X)) \quad X \sim U\left(0, \frac{\pi}{3}\right)
\]</span></p>
<ol style="list-style-type: decimal">
<li><p>Generate <span class="math inline">\(X_{1}\)</span> ,,<span class="math inline">\(X_{m}\)</span>, iid from Uniform<span class="math inline">\(\left(0, \frac{\pi}{3}\right)\)</span>.</p></li>
<li><p>Compute <span class="math inline">\(\overline{g(X)}=\frac{1}{m} \sum_{i=1}^{m} g\left(X_{i}\right)\)</span>.</p></li>
<li><p><span class="math inline">\(\hat{\theta}=(\frac{\pi}{3}-0) \overline{g(X)}\)</span>.</p></li>
</ol>
<p>We can certainly handle this problem with analytic method, saying calculus. Thus we will compare the estimate with the exact value of the integral.</p>
<ul>
<li><h3 id="code">Code</h3></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">12345</span>)   
<span class="co"># for reproducible research </span>
m &lt;-<span class="fl">1e5</span>
x &lt;-<span class="kw">runif</span>(m,<span class="dv">0</span>,pi<span class="op">/</span><span class="dv">3</span>)
<span class="co"># X with uniform distribution</span>
g &lt;-(pi<span class="op">/</span><span class="dv">3</span>)<span class="op">*</span><span class="kw">sin</span>(x)
est1 &lt;-<span class="kw">mean</span>(g)
<span class="co"># Monte Carlo estimate of the integral</span>
<span class="kw">print</span>(<span class="kw">c</span>(est1,<span class="kw">cos</span>(<span class="dv">0</span>)<span class="op">-</span><span class="kw">cos</span>(pi<span class="op">/</span><span class="dv">3</span>)))</code></pre></div>
<pre><code>## [1] 0.500536 0.500000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># compare with the exact value</span></code></pre></div>
<p>It can be observed that our estimate is correct to three decimal places.</p>
<p>More reliably, the standard error of <span class="math inline">\(\hat{\theta}=\frac{1}{\mathrm{m}} \sum_{\mathrm{i}=1}^{\mathrm{m}} \mathrm{g}\left(\mathrm{x}_{\mathrm{i}}\right)\)</span> and error bounds are supposed to be given.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d &lt;-<span class="kw">sd</span>(g)<span class="op">/</span><span class="kw">sqrt</span>(m)
<span class="co"># standard error of Monte Carlo estimate</span>
<span class="kw">c</span>(est1 <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>d, est1 <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>d)</code></pre></div>
<pre><code>## [1] 0.4988800 0.5021921</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 95% confidence intervals</span></code></pre></div>
</div>
<div id="question-5.10" class="section level2">
<h2>Question <strong>5.10</strong></h2>
<p>Use Monte Carlo integration with antithetic variables to estimate <span class="math display">\[
\int_{0}^{1} \frac{e^{-x}}{1+x^{2}} d x
\]</span> and find the approximate reduction in variance as a percentage of the variance without variance reduction.</p>
</div>
<div id="answer-for-5.10" class="section level2">
<h2>Answer for <strong>5.10</strong></h2>
<ul>
<li><h3 id="basic-idea-1">Basic idea</h3></li>
</ul>
<ol style="list-style-type: decimal">
<li><p>Write a function to compute Monte Carlo estimate the same way as Q5.1.</p></li>
<li><p>Write a function to estimate the integral using Monte Carlo integration with antithetic variables.</p></li>
<li><p>Compare the two methods in terms of variance.</p></li>
</ol>
<ul>
<li><h3 id="code-1">Code</h3></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">MC &lt;-<span class="cf">function</span>(n){
  x &lt;-<span class="kw">runif</span>(n)
  g &lt;-<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)
  est101 &lt;-<span class="kw">mean</span>(g)
  est101
}
<span class="co"># function of Monte Carlo estimate without antithetic variables</span>
MC.anti&lt;-<span class="cf">function</span>(n){
  u &lt;-<span class="kw">runif</span>(n<span class="op">/</span><span class="dv">2</span>)
  v &lt;-<span class="dv">1</span><span class="op">-</span>u
  g1 &lt;-<span class="kw">exp</span>(<span class="op">-</span>u)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span>)
  g2 &lt;-<span class="kw">exp</span>(<span class="op">-</span>v)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>v<span class="op">^</span><span class="dv">2</span>)
<span class="co"># antithetic variables</span>
  est102 &lt;-<span class="kw">mean</span>(g1<span class="op">+</span>g2)<span class="op">/</span><span class="dv">2</span>
  est102
}
<span class="co"># function of Monte Carlo estimate with antithetic variables</span>
m &lt;-<span class="dv">1000</span>
<span class="kw">set.seed</span>(<span class="dv">321</span>)
MC1 &lt;-MC2 &lt;-<span class="kw">numeric</span>(m)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
  MC1[i] &lt;-<span class="kw">MC</span>(m)
  MC2[i] &lt;-<span class="kw">MC.anti</span>(m<span class="op">/</span><span class="dv">2</span>)
}</code></pre></div>
<p>A simulation under two methods, the simple Monte Carlo integration approach and the antithetic variable approach, has been done. Then we can estimate the approximate reduction in variance as follow.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>((<span class="kw">var</span>(MC1) <span class="op">-</span><span class="st"> </span><span class="kw">var</span>(MC2))<span class="op">/</span><span class="kw">var</span>(MC1))</code></pre></div>
<pre><code>## [1] 0.9297654</code></pre>
<p>The antithetic variable approach achieved approximately 92.98% reduction in variance.</p>
</div>
<div id="question-5.15" class="section level2">
<h2>Question <strong>5.15</strong></h2>
<p>Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10</p>
</div>
<div id="answer-for-5.15" class="section level2">
<h2>Answer for <strong>5.15</strong></h2>
<ul>
<li><h3 id="basic-idea-2">Basic idea</h3></li>
</ul>
<ol style="list-style-type: decimal">
<li>Devide the interval <span class="math inline">\((0,1)\)</span> into five intervals corresponding to equal areas 1/5 under the density <span class="math inline">\(f(x)\)</span> (impartance function <span class="math inline">\(f_{3}(x)\)</span> in expample 5.10) as below.</li>
</ol>
<p><span class="math inline">\(I_{1}=(0,0.135)\)</span>?? <span class="math inline">\(I_{2}=(0.135,0.291)\)</span>?? <span class="math inline">\(I_{3}=(0.291,0.477)\)</span>?? <span class="math inline">\(I_{4}=(0.477,0.705)\)</span>?? <span class="math inline">\(I_{5}=(0.705,1)\)</span></p>
<ol start="2" style="list-style-type: decimal">
<li>Define <span class="math display">\[
g_{j}(x)=\left\{\begin{array}{cc}{\frac{e^{-x}}{1+x^{2}}} &amp; {, x \in I_{j}} \\ {0} &amp; {, \text { else }}\end{array}\right.
\]</span></li>
</ol>
<p>On the <span class="math inline">\(j^{t h}\)</span> subinterval variables are generated from the density <span class="math display">\[
f_{j}(x)=\frac{5 e^{-x}}{1-e^{-1}} \quad x \in I_{j}
\]</span></p>
<p>For each j = 1,,5 we simulate an importance sample size r, compute the importance sampling estimator <span class="math inline">\(\hat{\theta}_{j}\)</span> of <span class="math inline">\(\theta_{j}\)</span> on the <span class="math inline">\(j^{t h}\)</span> subinterval, <span class="math inline">\(\hat{\theta}^{S I}= \sum_{j=1}^{k} \hat{\theta}_{j}\)</span></p>
<ol start="3" style="list-style-type: decimal">
<li><p>We also compute the importance sampling estimator with importance function <span class="math inline">\(f_{3}(x)\)</span> in example 5.10</p></li>
<li><p>Compare the results of two methods.</p></li>
</ol>
<ul>
<li><h3 id="code-2">Code</h3></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cdf &lt;-<span class="cf">function</span>(p){
  <span class="kw">uniroot</span>(<span class="cf">function</span>(x) <span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>x))<span class="op">-</span>p<span class="op">*</span>(<span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">-</span><span class="dv">1</span>),<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">tol=</span><span class="fl">1e-9</span>)<span class="op">$</span>root
}
<span class="co"># funtion to compute quantiles</span>
x &lt;-<span class="kw">numeric</span>(<span class="dv">6</span>)
p &lt;-<span class="kw">rep</span>(.<span class="dv">2</span>,<span class="dv">5</span>)
cp &lt;-<span class="kw">cumsum</span>(p)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>){
  x[i<span class="op">+</span><span class="dv">1</span>]&lt;-<span class="kw">cdf</span>(cp[i])
}
<span class="co"># five subintervals</span>
m &lt;-<span class="fl">1e4</span>
<span class="co"># number of replicates</span>
k &lt;-<span class="dv">5</span>
<span class="co"># number of strata</span>
r &lt;-<span class="st"> </span>m<span class="op">/</span>k
<span class="co"># replicates per stratum</span>
n &lt;-<span class="st"> </span><span class="dv">50</span> 
<span class="co"># number of times to repeat the estimation</span>
T &lt;-<span class="st"> </span><span class="kw">numeric</span>(k)
estimates &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,n,<span class="dv">2</span>)
g &lt;-<span class="st"> </span><span class="cf">function</span>(x){
  <span class="kw">exp</span>(<span class="op">-</span>x <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)) <span class="op">*</span><span class="st"> </span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">*</span><span class="st"> </span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>)
}
F &lt;-<span class="st"> </span><span class="cf">function</span>(x){
  <span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">*</span><span class="dv">5</span><span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)<span class="op">-</span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">*</span><span class="st"> </span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>)
}
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {
  v&lt;-<span class="st"> </span><span class="kw">runif</span>(m)
  <span class="co"># inverse transform method</span>
  s &lt;-<span class="st"> </span><span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>v <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))
  <span class="co"># random number generated from f3(x) in example 5.10</span>
  estimates[i, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">g</span>(s) <span class="op">/</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span>s) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))))
  <span class="co"># MC estimator with importance sampling method</span>
<span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){
  u&lt;-<span class="kw">runif</span>(r)
  <span class="co"># inverse transform method</span>
  <span class="co">#t&lt;-uniroot(function(y) F(y)-F(x[j])-u,c(0,1),tol=1e-9)$root</span>
  t&lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span>x[j])<span class="op">-</span>u<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))<span class="op">/</span><span class="dv">5</span>)
  <span class="co"># random number generated from f(x)</span>
  gi&lt;-<span class="kw">g</span>(t)
  fi&lt;-<span class="kw">exp</span>(<span class="op">-</span>t)<span class="op">*</span><span class="dv">5</span><span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))
  Y &lt;-<span class="st"> </span>gi<span class="op">/</span>fi
  T[j]&lt;-<span class="kw">mean</span>(Y)
  <span class="co"># MC estimator with importance sampling method in jth interval</span>
}
  estimates[i, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">sum</span>(T)
  <span class="co"># stratified importance sampling estimate</span>
}</code></pre></div>
<p>compute mean of r simulations of both methods.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">apply</span>(estimates, <span class="dv">2</span>, mean)</code></pre></div>
<pre><code>## [1] 0.5247500 0.5248312</code></pre>
<p>we can observe the mean of two methods is identical to three decimal places.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">apply</span>(estimates, <span class="dv">2</span>, var)</code></pre></div>
<pre><code>## [1] 1.208306e-06 4.572029e-08</code></pre>
<p>the variance tells stratified importance sampling can do much better than simple importance sampling.</p>
<ul>
<li><h3 id="wonder-2">Wonder</h3></li>
</ul>
<p>Is there any connection between the number of subinterval and the variance of our results?</p>
<div id="conjection-verification" class="section level4">
<h4>Conjection verification</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">xt &lt;-<span class="kw">numeric</span>(<span class="dv">11</span>)
pt &lt;-<span class="kw">rep</span>(.<span class="dv">1</span>,<span class="dv">10</span>)
cpt &lt;-<span class="kw">cumsum</span>(pt)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>){
  xt[i<span class="op">+</span><span class="dv">1</span>]&lt;-<span class="kw">cdf</span>(cpt[i])
}
kt &lt;-<span class="dv">10</span>
<span class="co"># number of strata</span>
rt &lt;-<span class="st"> </span>m<span class="op">/</span>kt
<span class="co"># replicates per stratum</span>
F &lt;-<span class="st"> </span><span class="kw">numeric</span>(kt)
test &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,n,<span class="dv">1</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {
  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>kt){
    ut&lt;-<span class="kw">runif</span>(rt)
    tt&lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span>xt[j])<span class="op">-</span>ut<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))<span class="op">/</span><span class="dv">10</span>)
    git&lt;-<span class="kw">g</span>(tt)
    fit&lt;-<span class="kw">exp</span>(<span class="op">-</span>tt)<span class="op">*</span><span class="dv">10</span><span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))
    Yt &lt;-<span class="st"> </span>git<span class="op">/</span>fit
    F[j]&lt;-<span class="kw">mean</span>(Yt)
  }
  <span class="co"># MC estimator with importance sampling method in jth interval</span>
  test[i] &lt;-<span class="st"> </span><span class="kw">sum</span>(F)
  <span class="co"># stratified importance sampling estimate</span>
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">mean</span>(test)</code></pre></div>
<pre><code>## [1] 0.5248044</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">var</span>(test)</code></pre></div>
<pre><code>##              [,1]
## [1,] 1.480173e-08</code></pre>
<p>Slight improvement can be observed when we apply narrower partition.</p>
</div>
</div>
<div id="question-6.5" class="section level2">
<h2>Question <strong>6.5</strong></h2>
<p>Suppose a <span class="math inline">\(95 \%\)</span> symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^{2}(2)\)</span> data with sample size n = 20. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
</div>
<div id="answer-for-6.5" class="section level2">
<h2>Answer for <strong>6.5</strong></h2>
<ul>
<li><h3 id="basic-idea-3">Basic idea</h3></li>
</ul>
<p>If <span class="math inline">\(X_{1}, \ldots, X_{n}\)</span> is a random sample from a Normal<span class="math inline">\(\left(\mu, \sigma^{2}\right)\)</span>distribution,<span class="math inline">\(n \geq 2\)</span>, then <span class="math display">\[
\frac{\bar{X}-E(\bar{X})}{\sqrt{\operatorname{Var}(\bar{X})}} \sim t(n-1)
\]</span></p>
<p>Though <span class="math inline">\(X \sim \chi^{2}(2)\)</span> now, we also use the above type to estimate mean and the upper confidence limit is <span class="math display">\[
\bar{X}+s d(\bar{X}) \cdot t_{1-\alpha}(n-1)
\]</span></p>
<div id="solution-processes" class="section level4">
<h4>Solution processes</h4>
<ol style="list-style-type: decimal">
<li><p>Set random sample size <span class="math inline">\(n\)</span> and confidence coefficient <span class="math inline">\(\alpha\)</span> (given in the item content)</p></li>
<li><p>Set simulation time <span class="math inline">\(m\)</span></p></li>
<li><p>Generate the <span class="math inline">\(j^{t h}\)</span> (<span class="math inline">\(j=1, \ldots, m\)</span>) random sample <span class="math inline">\(X_{1}^{(j)}, \ldots, X_{n}^{(j)}\)</span></p></li>
<li><p>Compute <span class="math inline">\(y_{j}=I\left(\bar{X} \in C_{j}\right)\)</span> for the <span class="math inline">\(j^{t h}\)</span> sample and teh empirical confidence level <span class="math inline">\(\bar{y}=\frac{1}{m} \sum_{j=1}^{m} y_{j}\)</span></p></li>
</ol>
<ul>
<li><h3 id="code-3">Code</h3></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())
<span class="co"># remove variables</span>
<span class="kw">set.seed</span>(<span class="dv">123</span>)
<span class="co"># for repruducible research</span>
n&lt;-<span class="dv">20</span>;alpha&lt;-.<span class="dv">05</span>
CI_<span class="dv">1</span>&lt;-<span class="cf">function</span>(a,b){
  x&lt;-<span class="kw">rchisq</span>(a,<span class="dv">2</span>)
  UCL&lt;-<span class="kw">mean</span>(x)<span class="op">+</span><span class="kw">sqrt</span>(<span class="kw">var</span>(x)<span class="op">/</span>a)<span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>b,<span class="dt">df=</span>a<span class="op">-</span><span class="dv">1</span>)
  <span class="kw">return</span>(UCL)
}
<span class="co"># function to obtain confidence interval appling t-interval</span>
CI_<span class="dv">2</span>&lt;-<span class="cf">function</span>(c,d){
  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(c, <span class="dt">mean=</span><span class="dv">0</span>, <span class="dt">sd=</span><span class="dv">2</span>)
  UCL&lt;-(c<span class="op">-</span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">qchisq</span>(d, <span class="dt">df=</span>c<span class="op">-</span><span class="dv">1</span>)
  <span class="kw">return</span>(UCL)
}
<span class="co"># function to obtain confidence interval in example 6.4</span></code></pre></div>
<p>Weve got functions to obtain two sorts of confidence interval respectively, now lets compare the results through some setted values.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m&lt;-<span class="fl">1e4</span>
<span class="co"># number of replication</span>
ci_<span class="dv">1</span>&lt;-<span class="kw">replicate</span>(m,<span class="dt">expr=</span><span class="kw">CI_1</span>(n,alpha))
<span class="co"># upper confidence limit appling t-interval</span>
ci_<span class="dv">2</span>&lt;-<span class="kw">replicate</span>(m,<span class="dt">expr=</span><span class="kw">CI_2</span>(n,alpha))
<span class="co"># upper confidence limit in example 6.4</span>
c&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">mean</span>(ci_<span class="dv">1</span><span class="op">&gt;</span><span class="dv">2</span>),<span class="kw">mean</span>(ci_<span class="dv">2</span><span class="op">&gt;</span><span class="dv">4</span>)),<span class="dv">1</span>,<span class="dv">2</span>)
<span class="co">#Monte Carlo estimates of confidence level</span>
<span class="kw">colnames</span>(c)&lt;-<span class="kw">c</span>(<span class="st">&quot;ECL_1&quot;</span>,<span class="st">&quot;ECL_2&quot;</span>)
pander<span class="op">::</span><span class="kw">pandoc.table</span>(c)</code></pre></div>
<table style="width:25%;">
<colgroup>
<col width="12%"></col>
<col width="12%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="center">ECL_1</th>
<th align="center">ECL_2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.8937</td>
<td align="center">0.9503</td>
</tr>
</tbody>
</table>
<p>We can observe that only 89.37% of the intervals contained the population mean, which is far from the 95% coverage under normality</p>
<ul>
<li><h3 id="wonder-3">Wonder</h3></li>
</ul>
<p>Is there any method which can improve the coverage probability?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">002</span>)
n_<span class="dv">2</span>&lt;-<span class="dv">40</span>;n_<span class="dv">3</span>&lt;-<span class="dv">80</span>;n_<span class="dv">4</span>&lt;-<span class="dv">160</span>
<span class="co"># a series of sample size</span>
ci_<span class="dv">11</span>&lt;-<span class="kw">replicate</span>(m,<span class="dt">expr=</span><span class="kw">CI_1</span>(n,alpha))
ci_<span class="dv">12</span>&lt;-<span class="kw">replicate</span>(m,<span class="dt">expr=</span><span class="kw">CI_1</span>(n_<span class="dv">2</span>,alpha))
ci_<span class="dv">13</span>&lt;-<span class="kw">replicate</span>(m,<span class="dt">expr=</span><span class="kw">CI_1</span>(n_<span class="dv">3</span>,alpha))
ci_<span class="dv">14</span>&lt;-<span class="kw">replicate</span>(m,<span class="dt">expr=</span><span class="kw">CI_1</span>(n_<span class="dv">4</span>,alpha))
d&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">mean</span>(ci_<span class="dv">11</span><span class="op">&gt;</span><span class="dv">2</span>),<span class="kw">mean</span>(ci_<span class="dv">12</span><span class="op">&gt;</span><span class="dv">2</span>),<span class="kw">mean</span>(ci_<span class="dv">13</span><span class="op">&gt;</span><span class="dv">2</span>),<span class="kw">mean</span>(ci_<span class="dv">14</span><span class="op">&gt;</span><span class="dv">2</span>)),<span class="dv">1</span>,<span class="dv">4</span>)
<span class="co">#Monte Carlo estimates of confidence level</span>
<span class="kw">colnames</span>(d)&lt;-<span class="kw">c</span>(<span class="st">&quot;n=20&quot;</span>,<span class="st">&quot;n=40&quot;</span>,<span class="st">&quot;n=80&quot;</span>,<span class="st">&quot;n=160&quot;</span>)
pander<span class="op">::</span><span class="kw">pandoc.table</span>(d)</code></pre></div>
<table style="width:50%;">
<colgroup>
<col width="12%"></col>
<col width="12%"></col>
<col width="12%"></col>
<col width="12%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="center">n=20</th>
<th align="center">n=40</th>
<th align="center">n=80</th>
<th align="center">n=160</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.8932</td>
<td align="center">0.9115</td>
<td align="center">0.9203</td>
<td align="center">0.93</td>
</tr>
</tbody>
</table>
<p>As clearly observed, the coverage probability improves with increasing sample size.</p>
<p>Its suggestive that an appropriate increase of sample size can work to improve coverage probability.</p>
</div>
</div>
<div id="question-6.6" class="section level2">
<h2>Question <strong>6.6</strong></h2>
<p>Estimate the 0.025, 0.05, 0.95, and 0.975 quantiles of the skewness <span class="math inline">\(\sqrt{b_{1}}\)</span> under normality by a Monte Carlo experiment. Compute the standard error of the estimates from (2.14) using the normal approximation for the density (with exact variance formula). Compare the estimated quantiles with the quantiles of the large sample approximation <span class="math inline">\(\sqrt{b_{1}} \approx N(0,6 / n)\)</span>.</p>
</div>
<div id="answer-for-6.6" class="section level2">
<h2>Answer for <strong>6.6</strong></h2>
<ul>
<li><h3 id="basic-idea-4">Basic idea</h3></li>
</ul>
<p>The skewness <span class="math inline">\(\sqrt{b_{1}}\)</span> is <span class="math display">\[
\sqrt{b_{1}}=\frac{\frac{1}{n} \sum_{i=1}^{n}\left(X_{i}-\bar{X}\right)^{3}}{\left(\frac{1}{n} \sum_{i=1}^{n}\left(X_{i}-\bar{X}\right)^{2}\right)^{3 / 2}}
\]</span></p>
<p>If <span class="math inline">\(X \sim N(0,1)\)</span>, then <span class="math inline">\(\sqrt{b_{1}} \approx N(0,6 / n)\)</span></p>
<p>Obviously, we can generate random numbers under normality to get samples of the skewness, then estimate quantiles of it by a Monte Carlo experiment.</p>
<div id="solution-processes-1" class="section level4">
<h4>Solution processes</h4>
<ol style="list-style-type: decimal">
<li><p>Set random sample size <span class="math inline">\(n\)</span> and simulation time <span class="math inline">\(m\)</span></p></li>
<li><p>Generate the <span class="math inline">\(j^{t h}\)</span> (<span class="math inline">\(j=1, \ldots, m\)</span>) random sample <span class="math inline">\(X_{1}^{(j)}, \ldots, X_{n}^{(j)}\)</span> under <span class="math inline">\(N(0,1)\)</span></p></li>
<li><p>Compute the skewness of sample <span class="math inline">\(\sqrt{b_{1}}^{(j)}\)</span></p></li>
<li><p>Estimate quantiles of the skewness by a Monte Carlo experiment</p></li>
<li><p>Obtain quantiles of variables under <span class="math inline">\(N(0,6 / n)\)</span></p></li>
<li><p>Compare the two sorts of quantiles</p></li>
<li><p>Compute the standard error of the estimates from (2.14) using the normal approximation for the density</p></li>
</ol>
<ul>
<li><h3 id="code-4">Code</h3></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())
<span class="co"># remove variables</span>
<span class="kw">set.seed</span>(<span class="dv">0321</span>)
n&lt;-<span class="fl">1e3</span>
<span class="co"># sample size</span>
m&lt;-<span class="fl">1e4</span>
<span class="co"># number of replication</span>
sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
<span class="co">#computes the sample skewness.</span>
xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)
m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)
m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)
<span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )
}
q1&lt;-<span class="kw">quantile</span>(<span class="kw">replicate</span>(m,<span class="dt">expr=</span><span class="kw">sk</span>(<span class="kw">rnorm</span>(n))),<span class="kw">c</span>(.<span class="dv">025</span>,.<span class="dv">05</span>,.<span class="dv">95</span>,.<span class="dv">975</span>))
<span class="co"># quantiles of the skewness under normality by a Monte Carlo experiment</span>
q2&lt;-<span class="kw">qnorm</span>(<span class="kw">c</span>(.<span class="dv">025</span>,.<span class="dv">05</span>,.<span class="dv">95</span>,.<span class="dv">975</span>),<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n))
<span class="co"># quantiles of the large sample approximation</span>
x&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(q1,q2),<span class="dv">2</span>,<span class="dv">4</span>,<span class="dt">byrow=</span>T)
<span class="kw">rownames</span>(x)&lt;-<span class="kw">c</span>(<span class="st">&quot;eatimate&quot;</span>,<span class="st">&quot;approximation&quot;</span>)
<span class="kw">colnames</span>(x)&lt;-<span class="kw">c</span>(<span class="st">&quot;0.025&quot;</span>,<span class="st">&quot;0.05&quot;</span>,<span class="st">&quot;0.95&quot;</span>,<span class="st">&quot;0.975&quot;</span>)
pander<span class="op">::</span><span class="kw">pandoc.table</span>(x)</code></pre></div>
<table style="width:81%;">
<colgroup>
<col width="27%"></col>
<col width="13%"></col>
<col width="13%"></col>
<col width="12%"></col>
<col width="12%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">0.025</th>
<th align="center">0.05</th>
<th align="center">0.95</th>
<th align="center">0.975</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>eatimate</strong></td>
<td align="center">-0.1528</td>
<td align="center">-0.1259</td>
<td align="center">0.1268</td>
<td align="center">0.1478</td>
</tr>
<tr class="even">
<td align="center"><strong>approximation</strong></td>
<td align="center">-0.1518</td>
<td align="center">-0.1274</td>
<td align="center">0.1274</td>
<td align="center">0.1518</td>
</tr>
</tbody>
</table>
<p>As is shown in the table, the estimated quantiles are close to the quantiles under <span class="math inline">\(N(0,6 / n)\)</span>.</p>
<p>Then compute the standard error of the estimates.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">007</span>)
sd&lt;-<span class="kw">numeric</span>(<span class="dv">4</span>)
c&lt;-<span class="kw">c</span>(.<span class="dv">025</span>,.<span class="dv">05</span>,.<span class="dv">95</span>,.<span class="dv">975</span>)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){
  sd[i]&lt;-<span class="kw">sqrt</span>(c[i]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>c[i])<span class="op">/</span>(n<span class="op">*</span>(<span class="kw">dnorm</span>(x[<span class="dv">1</span>,i],<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="op">-</span><span class="dv">2</span>)<span class="op">/</span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))<span class="op">^</span><span class="dv">2</span>)))
}
<span class="co"># standard error of the estimates</span>
y&lt;-<span class="kw">matrix</span>(sd,<span class="dv">1</span>,<span class="dv">4</span>)
<span class="kw">rownames</span>(y)&lt;-<span class="st">&quot;standard error&quot;</span>
<span class="kw">colnames</span>(y)&lt;-<span class="kw">c</span>(<span class="st">&quot;0.025&quot;</span>,<span class="st">&quot;0.05&quot;</span>,<span class="st">&quot;0.95&quot;</span>,<span class="st">&quot;0.975&quot;</span>)
pander<span class="op">::</span><span class="kw">pandoc.table</span>(y)</code></pre></div>
<table style="width:90%;">
<colgroup>
<col width="29%"></col>
<col width="15%"></col>
<col width="15%"></col>
<col width="15%"></col>
<col width="15%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">0.025</th>
<th align="center">0.05</th>
<th align="center">0.95</th>
<th align="center">0.975</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>standard error</strong></td>
<td align="center">0.006765</td>
<td align="center">0.005036</td>
<td align="center">0.005141</td>
<td align="center">0.005967</td>
</tr>
</tbody>
</table>
<ul>
<li><h3 id="wonder-4">Wonder</h3></li>
</ul>
<p>Decrease the sample size and see what will happen to standard error.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n_<span class="dv">2</span>&lt;-<span class="fl">1e2</span>
<span class="co"># decreased sample size</span>
sd_<span class="dv">2</span>&lt;-<span class="kw">numeric</span>(<span class="dv">4</span>)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){
  sd_<span class="dv">2</span>[i]&lt;-<span class="kw">sqrt</span>(c[i]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>c[i])<span class="op">/</span>(n_<span class="dv">2</span><span class="op">*</span>(<span class="kw">dnorm</span>(x[<span class="dv">1</span>,i],<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n_<span class="dv">2</span><span class="op">-</span><span class="dv">2</span>)<span class="op">/</span>((n_<span class="dv">2</span><span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n_<span class="dv">2</span><span class="op">+</span><span class="dv">3</span>))))<span class="op">^</span><span class="dv">2</span>)))
}
z&lt;-<span class="kw">matrix</span>(sd_<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">4</span>)
<span class="kw">rownames</span>(z)&lt;-<span class="st">&quot;standard error 2&quot;</span>
<span class="kw">colnames</span>(z)&lt;-<span class="kw">c</span>(<span class="st">&quot;0.025&quot;</span>,<span class="st">&quot;0.05&quot;</span>,<span class="st">&quot;0.95&quot;</span>,<span class="st">&quot;0.975&quot;</span>)
pander<span class="op">::</span><span class="kw">pandoc.table</span>(z)</code></pre></div>
<table style="width:88%;">
<colgroup>
<col width="31%"></col>
<col width="13%"></col>
<col width="13%"></col>
<col width="13%"></col>
<col width="13%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">0.025</th>
<th align="center">0.05</th>
<th align="center">0.95</th>
<th align="center">0.975</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>standard error 2</strong></td>
<td align="center">0.01144</td>
<td align="center">0.01494</td>
<td align="center">0.01497</td>
<td align="center">0.01129</td>
</tr>
</tbody>
</table>
<p>We can observe the standard error increases when sample size decreases, but more experiments are needed to draw a conclusion.</p>
</div>
</div>
<div id="question-7.6" class="section level2">
<h2>Question <strong>7.6</strong></h2>
<p>Efron and Tibshirani discuss the scor (bootstrap)test score data on 88 students who took examinations in five subjects. The first two tests (mechanics, vectors) were closed book and the last three tests (algebra, analysis, statistics) were open book. Each row of the data frame is a set of scores <span class="math inline">\(\left(x_{i 1}, \dots, x_{i 5}\right)\)</span> for the <span class="math inline">\(i^{t h}\)</span> student. Use a panel display to display the scatter plots for each pair of test scores. Compare the plot with the sample correlation matrix. Obtain bootstrap estimates of the standard errors for each of the following estimates: <span class="math inline">\(\hat{\rho}_{12}=\hat{\rho}(\mathrm{mec}, \mathrm{vec})\)</span>,<span class="math inline">\(\hat{\rho}_{34}=\hat{\rho}(\mathrm{alg}, \mathrm{ana})\)</span>,<span class="math inline">\(\hat{\rho}_{35}=\hat{\rho}(\mathrm{alg}, \mathrm{sta})\)</span>, <span class="math inline">\(\hat{\rho}_{45}=\hat{\rho}(\text { ana, sta })\)</span>.</p>
</div>
<div id="answer-for-7.6" class="section level2">
<h2>Answer for <strong>7.6</strong></h2>
<ul>
<li><h3 id="basic-idea-5">Basic idea</h3></li>
</ul>
<p>For using a panel display to display the scatter plots for each pair of test scores and comparing the plot with the sample correlation matrix, we found the <span class="math inline">\(pairs\)</span> function convenient to meet our requirements.</p>
<ul>
<li><h3 id="flowchart">Flowchart</h3></li>
</ul>
<ol style="list-style-type: decimal">
<li><p>Display the scatter plots for ten pairs of test scores with <span class="math inline">\(pairs\)</span> function.</p></li>
<li><p>Show the correlation coefficient of each pair of variables.(panel functions are taken from the <span class="math inline">\(pairs\)</span> help page)</p></li>
<li><p>Compare the scatter plots with the sample correlations.</p></li>
<li><p>Write a function that retures <span class="math inline">\(b^{t h}\)</span> replicate from <span class="math inline">\(b^{t h}\)</span> bootstrap sample, which denotes the sample correlation.</p></li>
<li><p>Using the <span class="math inline">\(boot\)</span> function to obtain bootstrap estimates of the standard errors for the four estimates respectively.</p></li>
</ol>
<ul>
<li><h3 id="code-5">Code</h3></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())
<span class="co"># remove variables</span>
<span class="co">#library(ggplot2)</span>
<span class="co"># to display scatter plots</span>
<span class="kw">library</span>(bootstrap)
<span class="co"># to obtain data</span>
panel.cor &lt;-<span class="st"> </span><span class="cf">function</span>(x, y, <span class="dt">digits =</span> <span class="dv">2</span>, <span class="dt">prefix =</span> <span class="st">&quot;&quot;</span>, cex.cor, ...)
{
  usr &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>); <span class="kw">on.exit</span>(<span class="kw">par</span>(usr))
  <span class="kw">par</span>(<span class="dt">usr =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>))
  r &lt;-<span class="st"> </span><span class="kw">abs</span>(<span class="kw">cor</span>(x, y))
  txt &lt;-<span class="st"> </span><span class="kw">format</span>(<span class="kw">c</span>(r, <span class="fl">0.123456789</span>), <span class="dt">digits =</span> digits)[<span class="dv">1</span>]
  txt &lt;-<span class="st"> </span><span class="kw">paste0</span>(prefix, txt)
  <span class="cf">if</span>(<span class="kw">missing</span>(cex.cor)) cex.cor &lt;-<span class="st"> </span><span class="fl">0.8</span><span class="op">/</span><span class="kw">strwidth</span>(txt)
  <span class="kw">text</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, txt, <span class="dt">cex =</span> cex.cor <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>r) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>)
}
<span class="co"># put (absolute) correlations on the upper panels with size proportional to the correlations</span>
<span class="kw">pairs</span>(scor,<span class="dt">upper.panel =</span> panel.cor,<span class="dt">gap=</span><span class="dv">0</span>, <span class="dt">row1attop=</span><span class="ot">FALSE</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As shown in the panel, the pair of scores with higher correlation has a more concentrated scatter distribution.</p>
<p>Then compute bootstrap estimates of the standard errors for the estimates in question.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">B &lt;-<span class="st"> </span><span class="fl">1e3</span>
<span class="kw">set.seed</span>(<span class="dv">1234</span>)
r12 &lt;-<span class="st"> </span><span class="cf">function</span>(x, i) {
<span class="co">#want correlation of columns 1 and 2</span>
<span class="kw">cor</span>(x[i,<span class="dv">1</span>], x[i,<span class="dv">2</span>])
}
r34 &lt;-<span class="st"> </span><span class="cf">function</span>(x, i) {
<span class="co">#want correlation of columns 3 and 4</span>
<span class="kw">cor</span>(x[i,<span class="dv">3</span>], x[i,<span class="dv">4</span>])
}
r35 &lt;-<span class="st"> </span><span class="cf">function</span>(x, i) {
<span class="co">#want correlation of columns 3 and 5</span>
<span class="kw">cor</span>(x[i,<span class="dv">3</span>], x[i,<span class="dv">5</span>])
}
r45 &lt;-<span class="st"> </span><span class="cf">function</span>(x, i) {
<span class="co">#want correlation of columns 4 and 5</span>
<span class="kw">cor</span>(x[i,<span class="dv">4</span>], x[i,<span class="dv">5</span>])
}
<span class="kw">library</span>(boot) 
<span class="co"># for boot function</span>
sd_boot&lt;-<span class="kw">numeric</span>(<span class="dv">4</span>)
<span class="co">#for (i in 1:4){</span>
sd_boot[<span class="dv">1</span>]&lt;-<span class="kw">sd</span>(<span class="kw">boot</span>(<span class="dt">data=</span>scor,<span class="dt">statistic=</span>r12,<span class="dt">R=</span><span class="dv">2000</span>)<span class="op">$</span>t)
sd_boot[<span class="dv">2</span>]&lt;-<span class="kw">sd</span>(<span class="kw">boot</span>(<span class="dt">data=</span>scor,<span class="dt">statistic=</span>r34,<span class="dt">R=</span><span class="dv">2000</span>)<span class="op">$</span>t)
sd_boot[<span class="dv">3</span>]&lt;-<span class="kw">sd</span>(<span class="kw">boot</span>(<span class="dt">data=</span>scor,<span class="dt">statistic=</span>r35,<span class="dt">R=</span><span class="dv">2000</span>)<span class="op">$</span>t)
sd_boot[<span class="dv">4</span>]&lt;-<span class="kw">sd</span>(<span class="kw">boot</span>(<span class="dt">data=</span>scor,<span class="dt">statistic=</span>r45,<span class="dt">R=</span><span class="dv">2000</span>)<span class="op">$</span>t)
<span class="co">#}</span>
a&lt;-<span class="kw">matrix</span>(sd_boot,<span class="dv">1</span>,<span class="dv">4</span>)
<span class="kw">colnames</span>(a)&lt;-<span class="kw">c</span>(<span class="st">&quot;Cor(1,2)&quot;</span>,<span class="st">&quot;Cor(3,4)&quot;</span>,<span class="st">&quot;Cor(3,5)&quot;</span>,<span class="st">&quot;Cor(4,5)&quot;</span>)
<span class="kw">rownames</span>(a)&lt;-<span class="st">&quot;sd.boot&quot;</span>
pander<span class="op">::</span><span class="kw">pandoc.table</span>(a)</code></pre></div>
<table style="width:81%;">
<colgroup>
<col width="19%"></col>
<col width="15%"></col>
<col width="15%"></col>
<col width="15%"></col>
<col width="15%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">Cor(1,2)</th>
<th align="center">Cor(3,4)</th>
<th align="center">Cor(3,5)</th>
<th align="center">Cor(4,5)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>sd.boot</strong></td>
<td align="center">0.07733</td>
<td align="center">0.04684</td>
<td align="center">0.05961</td>
<td align="center">0.06638</td>
</tr>
</tbody>
</table>
</div>
<div id="question-7.b" class="section level2">
<h2>Question <strong>7.B</strong></h2>
<p>Conduct a Monte Carlo study to estimate the coverage probabilities of the standard normal bootstrap confidence interval, the basic bootstrap confidence interval, and the percentile confidence interval. Sample from normal populations (skewness 0) and <span class="math inline">\(\chi^{2}(5)\)</span> distributions (positive skewness) and compare the empirical coverage rates for the sample skewness statistic. Find the proportion of times that the confidence intervals miss on the left, and the porportion of times that the confidence intervals miss on the right.</p>
</div>
<div id="answer-for-7.b" class="section level2">
<h2>Answer for <strong>7.B</strong></h2>
<ul>
<li><h3 id="basic-idea-6">Basic idea</h3>
<p>There are several approaches to obtaining approximate confidence intervals for the sample skewness in a bootstrap. The methods include the standard normal bootstrap confidence interval, the basic bootstrap confidence interval and the bootstrap percentile confidence interval.</p></li>
<li><h3 id="flowchart-1">Flowchart</h3></li>
</ul>
<ol style="list-style-type: decimal">
<li><p>Choose sample size n for the skewness.</p></li>
<li><p>Choose sample size m for bootstrap confidence interval.</p></li>
<li><p>Choose number of replicate for empirical coverage rates.</p></li>
<li><p>Run R function boot.ci{boot} implements the three bootstrap CI methods.</p></li>
<li><p>Conduct a Monte Carlo study to estimate the coverage probabilities and the proportion of times that the CI miss on the left along with on the right for the three bootstrap CI methods with normal population and <span class="math inline">\(\chi^{2}(5)\)</span> distributions respectively.</p></li>
</ol>
<ul>
<li><h3 id="code-6">Code</h3></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())
<span class="co"># remove variables</span>
<span class="kw">library</span>(boot)
<span class="kw">set.seed</span>(<span class="dv">0321</span>)
sk_nor&lt;-<span class="dv">0</span>;sk_chi&lt;-<span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">5</span><span class="op">/</span><span class="dv">2</span>)
<span class="co"># skewnesses with normal distribution and chi-square distribution</span>
n &lt;-<span class="st"> </span><span class="dv">20</span>
<span class="co"># sample size for statistic</span>
m&lt;-<span class="dv">10</span>
<span class="co"># sample size for confidence interval</span>
M&lt;-<span class="fl">1e2</span>
<span class="co"># number of replicate for empirical coverage rates</span>
sk.boot &lt;-<span class="st"> </span><span class="cf">function</span>(x,i) {
  <span class="co"># function to compute the sample skewness statistic</span>
  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x[i,])
  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x[i,] <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)
  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x[i,] <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)
  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )
}
ci.norm_nor&lt;-ci.norm_chi&lt;-ci.basic_nor&lt;-ci.basic_chi&lt;-ci.perc_nor&lt;-ci.perc_chi&lt;-<span class="kw">matrix</span>(<span class="ot">NA</span>,M,<span class="dv">2</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>M){
  x&lt;-<span class="kw">matrix</span>(<span class="kw">rnorm</span>(m<span class="op">*</span>n),m,n)
  <span class="co"># sample from normal population</span>
  y&lt;-<span class="kw">matrix</span>(<span class="kw">rchisq</span>(m<span class="op">*</span>n,<span class="dv">5</span>),m,n)
  <span class="co"># sample from chi-square population</span>
  de_nor &lt;-<span class="st"> </span><span class="kw">boot</span>(x, <span class="dt">statistic =</span> sk.boot, <span class="dt">R =</span> <span class="dv">1000</span>)
  ci_nor &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(de_nor,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))
  <span class="co"># bootstrap CI for normality</span>
  de_chi &lt;-<span class="st"> </span><span class="kw">boot</span>(y, <span class="dt">statistic =</span> sk.boot, <span class="dt">R =</span> <span class="dv">1000</span>)
  ci_chi &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(de_chi,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))
  <span class="co"># bootstrap CI for chi-square</span>
  ci.norm_nor[i,]&lt;-ci_nor<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]
  ci.basic_nor[i,]&lt;-ci_nor<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]
  ci.perc_nor[i,]&lt;-ci_nor<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]
  <span class="co"># extract three sorts of CI for normality</span>
  ci.norm_chi[i,]&lt;-ci_chi<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]
  ci.basic_chi[i,]&lt;-ci_chi<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]
  ci.perc_chi[i,]&lt;-ci_chi<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]
  <span class="co"># extract three sorts of CI for chi-square</span>
}
CR_nor &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(ci.norm_nor[,<span class="dv">1</span>]<span class="op">&lt;=</span>sk_nor <span class="op">&amp;</span><span class="st"> </span>ci.norm_nor[,<span class="dv">2</span>]<span class="op">&gt;=</span>sk_nor),<span class="kw">mean</span>(ci.basic_nor[,<span class="dv">1</span>]<span class="op">&lt;=</span>sk_nor <span class="op">&amp;</span><span class="st"> </span>ci.basic_nor[,<span class="dv">2</span>]<span class="op">&gt;=</span>sk_nor),<span class="kw">mean</span>(ci.perc_nor[,<span class="dv">1</span>]<span class="op">&lt;=</span>sk_nor <span class="op">&amp;</span><span class="st"> </span>ci.perc_nor[,<span class="dv">2</span>]<span class="op">&gt;=</span>sk_nor),<span class="kw">mean</span>(ci.norm_nor[,<span class="dv">1</span>]<span class="op">&gt;=</span>sk_nor ),<span class="kw">mean</span>(ci.basic_nor[,<span class="dv">1</span>]<span class="op">&gt;=</span>sk_nor),<span class="kw">mean</span>(ci.perc_nor[,<span class="dv">1</span>]<span class="op">&gt;=</span>sk_nor),<span class="kw">mean</span>(ci.norm_nor[,<span class="dv">2</span>]<span class="op">&lt;=</span>sk_nor ),<span class="kw">mean</span>(ci.basic_nor[,<span class="dv">2</span>]<span class="op">&lt;=</span>sk_nor),<span class="kw">mean</span>(ci.perc_nor[,<span class="dv">2</span>]<span class="op">&lt;=</span>sk_nor))
<span class="co"># Monte Carlo estimates of CI and miss rates of both sides for normality</span>
b&lt;-<span class="kw">matrix</span>(CR_nor,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dt">byrow=</span>T)
<span class="kw">colnames</span>(b)&lt;-<span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>)
<span class="kw">rownames</span>(b)&lt;-<span class="kw">c</span>(<span class="st">&quot;CR for normality&quot;</span>,<span class="st">&quot;miss rates on the left&quot;</span>,<span class="st">&quot;miss rates on the right&quot;</span>)

CR_chi &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(ci.norm_chi[,<span class="dv">1</span>]<span class="op">&lt;=</span>sk_chi <span class="op">&amp;</span><span class="st"> </span>ci.norm_chi[,<span class="dv">2</span>]<span class="op">&gt;=</span>sk_chi),<span class="kw">mean</span>(ci.basic_chi[,<span class="dv">1</span>]<span class="op">&lt;=</span>sk_chi <span class="op">&amp;</span><span class="st"> </span>ci.basic_chi[,<span class="dv">2</span>]<span class="op">&gt;=</span>sk_chi),<span class="kw">mean</span>(ci.perc_chi[,<span class="dv">1</span>]<span class="op">&lt;=</span>sk_chi <span class="op">&amp;</span><span class="st"> </span>ci.perc_chi[,<span class="dv">2</span>]<span class="op">&gt;=</span>sk_chi),<span class="kw">mean</span>(ci.norm_chi[,<span class="dv">1</span>]<span class="op">&gt;=</span>sk_chi ),<span class="kw">mean</span>(ci.basic_chi[,<span class="dv">1</span>]<span class="op">&gt;=</span>sk_chi),<span class="kw">mean</span>(ci.perc_chi[,<span class="dv">1</span>]<span class="op">&gt;=</span>sk_chi),<span class="kw">mean</span>(ci.norm_chi[,<span class="dv">2</span>]<span class="op">&lt;=</span>sk_chi ),<span class="kw">mean</span>(ci.basic_chi[,<span class="dv">2</span>]<span class="op">&lt;=</span>sk_chi),<span class="kw">mean</span>(ci.perc_chi[,<span class="dv">2</span>]<span class="op">&lt;=</span>sk_chi))
<span class="co">#Monte Carlo estimates of CI and miss rates of both sides for chi-square</span>
c&lt;-<span class="kw">matrix</span>(CR_chi,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dt">byrow=</span>T)
<span class="kw">colnames</span>(c)&lt;-<span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>)
<span class="kw">rownames</span>(c)&lt;-<span class="kw">c</span>(<span class="st">&quot;CR for chi-square&quot;</span>,<span class="st">&quot;miss rates on the left&quot;</span>,<span class="st">&quot;miss rates on the right&quot;</span>)

pander<span class="op">::</span><span class="kw">pandoc.table</span>(b)</code></pre></div>
<table style="width:74%;">
<colgroup>
<col width="41%"></col>
<col width="9%"></col>
<col width="11%"></col>
<col width="11%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">norm</th>
<th align="center">basic</th>
<th align="center">perc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>CR for normality</strong></td>
<td align="center">0.9</td>
<td align="center">0.89</td>
<td align="center">0.92</td>
</tr>
<tr class="even">
<td align="center"><strong>miss rates on the left</strong></td>
<td align="center">0.05</td>
<td align="center">0.05</td>
<td align="center">0.03</td>
</tr>
<tr class="odd">
<td align="center"><strong>miss rates on the right</strong></td>
<td align="center">0.05</td>
<td align="center">0.06</td>
<td align="center">0.05</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pander<span class="op">::</span><span class="kw">pandoc.table</span>(c)</code></pre></div>
<table style="width:74%;">
<colgroup>
<col width="41%"></col>
<col width="9%"></col>
<col width="11%"></col>
<col width="11%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">norm</th>
<th align="center">basic</th>
<th align="center">perc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>CR for chi-square</strong></td>
<td align="center">0.79</td>
<td align="center">0.75</td>
<td align="center">0.75</td>
</tr>
<tr class="even">
<td align="center"><strong>miss rates on the left</strong></td>
<td align="center">0.03</td>
<td align="center">0.06</td>
<td align="center">0.02</td>
</tr>
<tr class="odd">
<td align="center"><strong>miss rates on the right</strong></td>
<td align="center">0.18</td>
<td align="center">0.19</td>
<td align="center">0.23</td>
</tr>
</tbody>
</table>
<p>We can observe that for normal populations, the coverage rates for the sample skewness are higher than for <span class="math inline">\(\chi^{2}(5)\)</span> distributions in all the three kinds of confidence interval.</p>
<p>At the same time, for normality the miss rates on the left are close to that on the right, while for <span class="math inline">\(\chi^{2}(5)\)</span> distributions the confidence interval always have higher miss rates on the right than on the left. Assume thats the result of difference of distribution symmetry now lets check our assumption.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">123</span>)
sk_exp&lt;-<span class="dv">2</span>
<span class="co"># skewnesses with exponential distribution</span>
ci.norm_exp&lt;-ci.perc_exp&lt;-ci.basic_exp&lt;-<span class="kw">matrix</span>(<span class="ot">NA</span>,M,<span class="dv">2</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>M){
  x&lt;-<span class="kw">matrix</span>(<span class="kw">rexp</span>(m<span class="op">*</span>n,<span class="dv">2</span>),m,n)
  <span class="co"># sample from exp(2) population</span>
  de_exp &lt;-<span class="st"> </span><span class="kw">boot</span>(x, <span class="dt">statistic =</span> sk.boot, <span class="dt">R =</span> <span class="dv">1000</span>)
  ci_exp &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(de_exp,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))
  <span class="co"># bootstrap CI for exponential distribution</span>
  ci.norm_exp[i,]&lt;-ci_exp<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]
  ci.basic_exp[i,]&lt;-ci_exp<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]
  ci.perc_exp[i,]&lt;-ci_exp<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]
  <span class="co"># extract three sorts of CI for exponential distribution</span>
}
  CR_exp &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(ci.norm_exp[,<span class="dv">1</span>]<span class="op">&lt;=</span>sk_exp <span class="op">&amp;</span><span class="st"> </span>ci.norm_exp[,<span class="dv">2</span>]<span class="op">&gt;=</span>sk_exp),<span class="kw">mean</span>(ci.basic_exp[,<span class="dv">1</span>]<span class="op">&lt;=</span>sk_exp <span class="op">&amp;</span><span class="st"> </span>ci.basic_exp[,<span class="dv">2</span>]<span class="op">&gt;=</span>sk_exp),<span class="kw">mean</span>(ci.perc_exp[,<span class="dv">1</span>]<span class="op">&lt;=</span>sk_exp <span class="op">&amp;</span><span class="st"> </span>ci.perc_exp[,<span class="dv">2</span>]<span class="op">&gt;=</span>sk_exp),<span class="kw">mean</span>(ci.norm_exp[,<span class="dv">1</span>]<span class="op">&gt;=</span>sk_exp ),<span class="kw">mean</span>(ci.basic_exp[,<span class="dv">1</span>]<span class="op">&gt;=</span>sk_exp),<span class="kw">mean</span>(ci.perc_exp[,<span class="dv">1</span>]<span class="op">&gt;=</span>sk_exp),<span class="kw">mean</span>(ci.norm_exp[,<span class="dv">2</span>]<span class="op">&lt;=</span>sk_exp ),<span class="kw">mean</span>(ci.basic_exp[,<span class="dv">2</span>]<span class="op">&lt;=</span>sk_exp),<span class="kw">mean</span>(ci.perc_exp[,<span class="dv">2</span>]<span class="op">&lt;=</span>sk_exp))
<span class="co"># Monte Carlo estimates of CI and miss rates of both sides for exponential</span>
d&lt;-<span class="kw">matrix</span>(CR_exp,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dt">byrow=</span>T)
<span class="kw">colnames</span>(d)&lt;-<span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>)
<span class="kw">rownames</span>(d)&lt;-<span class="kw">c</span>(<span class="st">&quot;CR for exp(2)&quot;</span>,<span class="st">&quot;miss rates on the left&quot;</span>,<span class="st">&quot;miss rates on the right&quot;</span>)
pander<span class="op">::</span><span class="kw">pandoc.table</span>(d)</code></pre></div>
<table style="width:74%;">
<colgroup>
<col width="41%"></col>
<col width="9%"></col>
<col width="11%"></col>
<col width="11%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">norm</th>
<th align="center">basic</th>
<th align="center">perc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>CR for exp(2)</strong></td>
<td align="center">0.68</td>
<td align="center">0.65</td>
<td align="center">0.64</td>
</tr>
<tr class="even">
<td align="center"><strong>miss rates on the left</strong></td>
<td align="center">0.04</td>
<td align="center">0.08</td>
<td align="center">0.01</td>
</tr>
<tr class="odd">
<td align="center"><strong>miss rates on the right</strong></td>
<td align="center">0.28</td>
<td align="center">0.27</td>
<td align="center">0.35</td>
</tr>
</tbody>
</table>
<p>For exp(2) population, we observed the same situation as <span class="math inline">\(\chi^{2}(5)\)</span> distributions in regard to the significant differentiation between miss rates on the left and on the right.</p>
</div>
<div id="question-6.7" class="section level2">
<h2>Question <strong>6.7</strong></h2>
<p>Estimate the power of the skewness test of normality against symmetric <span class="math inline">\(\operatorname{Beta}(\alpha, \alpha)\)</span> distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(\nu)\)</span>?</p>
</div>
<div id="answer-for-6.7" class="section level2">
<h2>Answer for <strong>6.7</strong></h2>
<ul>
<li><h3 id="basic-idea-7">Basic idea</h3></li>
</ul>
<p>The skewness <span class="math inline">\(\sqrt{\beta_{1}}\)</span> of a random variable <span class="math inline">\(X\)</span> is defined by <span class="math display">\[
\sqrt{\beta_{1}}=\frac{E\left[\left(X-\mu_{X}\right)\right]^{3}}{\sigma_{X}^{3}}
\]</span> The sample coefficient of skewness is denoted by <span class="math inline">\(\sqrt{b_{1}}\)</span>, and defined as <span class="math display">\[
\sqrt{b_{1}}=\frac{\frac{1}{n} \sum_{i=1}^{n}\left(X_{i}-\bar{X}\right)^{3}}{\left(\frac{1}{n} \sum_{i=1}^{n}\left(X_{i}-\bar{X}\right)^{2}\right)^{3 / 2}}
\]</span> If the distribution of <span class="math inline">\(X\)</span> is normal, then <span class="math inline">\(\sqrt{b_{1}}\)</span> is asymptotically normal with mean 0 and variance <span class="math inline">\(\frac{6(n-2)}{(n+1)(n+3)}\)</span>. The hypotheses are <span class="math display">\[
H_{0}: \sqrt{\beta_{1}}=0 ; \quad H_{1}: \sqrt{\beta_{1}} \neq 0
\]</span> First, we estimate by simulation the power of the skewness test of normality against symmetric <span class="math inline">\(\operatorname{Beta}(\alpha, \alpha)\)</span> distributions, which is denoted by <span class="math inline">\(\operatorname{Beta}(\alpha, \alpha)\)</span>.</p>
<p>Then comes two sorts of heavy-tailed symmetric alternatives, <span class="math inline">\(t(\nu)\)</span> and <span class="math inline">\(U(0,1)\)</span>, compare the results and draw some conclusions.</p>
<div id="flowchart-2" class="section level4">
<h4>Flowchart</h4>
<ol style="list-style-type: decimal">
<li><p>Set random sample size <span class="math inline">\(n\)</span> and confidence coefficient <span class="math inline">\(\alpha\)</span></p></li>
<li><p>Set simulation time <span class="math inline">\(m\)</span></p></li>
<li><p>Generate the <span class="math inline">\(j^{t h}\)</span> (<span class="math inline">\(j=1, \ldots, m\)</span>) random sample <span class="math inline">\(X_{1}^{(j)}, \ldots, X_{n}^{(j)}\)</span> under the conditions of symmetric <span class="math inline">\(\operatorname{Beta}(\alpha, \alpha)\)</span> distributions</p></li>
<li><p>Estimate the power of the skewness test of normality against symmetric <span class="math inline">\(\operatorname{Beta}(\alpha, \alpha)\)</span> distributions</p></li>
<li><p>Choose two sorts of heavy-tailed symmetric alternatives, <span class="math inline">\(t(\nu)\)</span> and <span class="math inline">\(U(0,a)\)</span>, generate random sample under the conditions of the two respectively</p></li>
<li><p>Estimate the power of the skewness test of normality against the two heavy-tailed symmetric alternatives</p></li>
</ol>
<ul>
<li><h3 id="code-7">Code</h3></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())
<span class="co"># remove variables</span>
<span class="kw">set.seed</span>(<span class="dv">123</span>)
alpha &lt;-<span class="st"> </span>.<span class="dv">1</span>
n &lt;-<span class="st"> </span><span class="dv">30</span>
m &lt;-<span class="st"> </span><span class="dv">2500</span>
a&lt;-<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">20</span>) <span class="co"># parameter of Beta distribution</span>
<span class="co">#epsilon &lt;- c(seq(0, .15, .01), seq(.15, 1, .05))</span>
<span class="co">#N &lt;- length(epsilon)</span>
N &lt;-<span class="st"> </span><span class="kw">length</span>(a)
power &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)
sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
  <span class="co"># computes the sample skewness coeff.</span>
  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)
  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)
  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)
  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )
}
cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="op">-</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))
<span class="co"># critical value for the skewness test</span>
<span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each parameter of Beta distribution</span>
e &lt;-<span class="st"> </span>a[j]
stests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span>
  x&lt;-<span class="st"> </span><span class="kw">rbeta</span>(n,e,e)
  stests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)
}
power[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(stests)
}
<span class="co">#plot power vs parameter of Beta distribution</span>
<span class="kw">plot</span>(a, power, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">xlab =</span> <span class="kw">bquote</span>(alpha), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))
<span class="kw">abline</span>(<span class="dt">h =</span> .<span class="dv">1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)
se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(power <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>power) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors</span>
<span class="kw">lines</span>(a, power<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)
<span class="kw">lines</span>(a, power<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>For <span class="math inline">\(1 \leq \alpha \leq 20\)</span> (<span class="math inline">\(\alpha\)</span> denotes the parameter of Beta distribution) the power curve always below the horizontal line corresponding to <span class="math inline">\(\alpha\)</span>=0.10, which means to reject the null hypotheses.</p>
<p>Then about the two heavy-tailed symmetric alternatives.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">power_<span class="dv">2</span> &lt;-<span class="st"> </span>power_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)
<span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each parameter of t distribution</span>
e &lt;-<span class="st"> </span>a[j]
stests_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span>
  x &lt;-<span class="st"> </span><span class="kw">rt</span>(n,e)
  stests_<span class="dv">2</span>[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)
}
power_<span class="dv">2</span>[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(stests_<span class="dv">2</span>)
}
<span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each parameter of uniform distribution</span>
e &lt;-<span class="st"> </span>a[j]
stests_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span>
  x &lt;-<span class="st"> </span><span class="kw">runif</span>(n,<span class="dv">0</span>,e)
  stests_<span class="dv">3</span>[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)
}
power_<span class="dv">3</span>[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(stests_<span class="dv">3</span>)
}
<span class="kw">plot</span>(a,power, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;parameter&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">ylab=</span><span class="st">&quot;power&quot;</span>)
<span class="kw">lines</span>(a,power_<span class="dv">2</span>,<span class="dt">lty=</span><span class="dv">2</span>)
<span class="kw">lines</span>(a,power_<span class="dv">3</span>,<span class="dt">lty=</span><span class="dv">3</span>)
<span class="kw">abline</span>(<span class="dt">h =</span> alpha, <span class="dt">lty =</span> <span class="dv">4</span>)
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="dv">1</span>,<span class="kw">c</span>(<span class="st">&quot;normal&quot;</span>,<span class="st">&quot;t&quot;</span>,<span class="st">&quot;unif&quot;</span>),<span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="dt">inset=</span>.<span class="dv">02</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can observe the power curve of uniform distribution with differrent thresholds is far close to the horizontal line corresponding to <span class="math inline">\(\alpha\)</span>=0, which absolutely means to reject the null hypotheses. On the contrary, the t distribution shows acceptance of the null hypotheses and its power curve decreases with degrees of freedom increases.</p>
<p>In conclusion, <span class="math inline">\(t(\nu)\)</span> is suitable for the skewness test of normality.</p>
<ul>
<li><h3 id="wonder-5">Wonder</h3></li>
</ul>
<p>Consider the underlying reason for the tendency of t distribution power curve.</p>
</div>
</div>
<div id="question-6.a" class="section level2">
<h2>Question <strong>6.A</strong></h2>
<p>Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the t-test is approximately equal to the nominal significance level <span class="math inline">\(\alpha\)</span>, when the sampled population is non-normal. The t-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is (i) <span class="math inline">\(\chi^{2}(1)\)</span>, (ii) Uniform(0,2), and (iii) Exponential(rate=1). In each case, test <span class="math inline">\(H_{0}: \mu=\mu_{0}\)</span> vs <span class="math inline">\(H_{0}: \mu \neq \mu_{0}\)</span> , where <span class="math inline">\(\mu_{0}\)</span> is the mean of <span class="math inline">\(\chi^{2}(1)\)</span>, Uniform(0,2), and Exponential(1), respectively.</p>
</div>
<div id="answer-for-6.a" class="section level2">
<h2>Answer for <strong>6.A</strong></h2>
<ul>
<li><h3 id="basic-idea-8">Basic idea</h3></li>
</ul>
<p>Suppose that <span class="math inline">\(X_{1}, \ldots, X_{20}\)</span> is a random sample from a <span class="math inline">\(N\left(\mu, \sigma^{2}\right)\)</span> distribution. Test <span class="math inline">\(H_{0}\)</span> : ?? = 1 <span class="math inline">\(H_{1}\)</span> : ?? &gt; 1 at <span class="math inline">\(\alpha\)</span> = 0.05. Under the null hypothesis, <span class="math display">\[
T^{*}=\frac{\bar{X}-1}{S / \sqrt{20}} \sim t(19)
\]</span> where t(19) denotes the Student t distribution with 19 degrees of freedom. Large values of <span class="math inline">\(T^{*}\)</span> support the alternative hypothesis.</p>
<p>Generate samples from non-normal distribution ,say (i) <span class="math inline">\(\chi^{2}(1)\)</span>, (ii) Uniform(0,2), (iii) Exponential(rate=1), and see whether the empirical Type I error rate of the t-test is approximately equal to the nominal significance level <span class="math inline">\(\alpha\)</span>.</p>
<ul>
<li><h3 id="code-8">Code</h3></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())
<span class="co"># remove variables</span>
<span class="kw">set.seed</span>(<span class="dv">0321</span>)
n &lt;-<span class="st"> </span><span class="dv">20</span>
<span class="co"># sample size</span>
m&lt;-<span class="fl">1e4</span>
<span class="co"># number of replication</span>
p &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span>m,<span class="dt">ncol=</span><span class="dv">3</span>)
p.hat &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">3</span>)
alpha&lt;-.<span class="dv">05</span>
mu0 &lt;-<span class="st"> </span><span class="dv">1</span>

<span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,n,<span class="dv">3</span>)
  x[,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dv">1</span>) <span class="co"># random numbers from chi-square distribution</span>
  x[,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>) <span class="co"># random numbers from uniform distribution</span>
  x[,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">rexp</span>(n,<span class="dv">1</span>) <span class="co"># random numbers from exponential distribution</span>
  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>){
    ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x[,k],<span class="dt">alternative=</span><span class="st">&quot;greater&quot;</span>,<span class="dt">mu=</span>mu0)
    p[j,k] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value
  }
}
p.hat &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p<span class="op">&lt;</span>alpha)
c&lt;-<span class="kw">matrix</span>(p.hat,<span class="dv">1</span>,<span class="dv">3</span>)
<span class="co">#Monte Carlo estimates of confidence level</span>
<span class="kw">colnames</span>(c)&lt;-<span class="kw">c</span>(<span class="st">&quot;Chi-square&quot;</span>,<span class="st">&quot;Uniform&quot;</span>,<span class="st">&quot;Exponential&quot;</span>)
<span class="kw">rownames</span>(c)&lt;-<span class="st">&quot;p.hat&quot;</span>
pander<span class="op">::</span><span class="kw">pandoc.table</span>(c)</code></pre></div>
<table style="width:67%;">
<colgroup>
<col width="16%"></col>
<col width="18%"></col>
<col width="13%"></col>
<col width="18%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">Chi-square</th>
<th align="center">Uniform</th>
<th align="center">Exponential</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>p.hat</strong></td>
<td align="center">0.013</td>
<td align="center">0.0498</td>
<td align="center">0.0184</td>
</tr>
</tbody>
</table>
<p>We can observe the empirical Type I error rate of samples generate from <span class="math inline">\(\chi^{2}(1)\)</span> and Exponential(rate=1) are far from the nominal significance level <span class="math inline">\(\alpha\)</span>, which is said to be conservative, while the Uniform(0,2) sample have a empirical Type I error rate approximately equal to the nominal significance level <span class="math inline">\(\alpha\)</span>.</p>
</div>
<div id="discussion" class="section level2">
<h2>Discussion</h2>
<p>If we obtain the power for two methods under a particular simulation setting with 10,000 experiments: say,0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level?</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<ul>
<li><h3 id="basic-idea-9">Basic idea</h3></li>
</ul>
<p>power<span class="math inline">\(_{-}1\)</span> denotes the empirical power for method 1 and power<span class="math inline">\(_{-}2\)</span> denotes the empirical power for the other.</p>
<p>letting <span class="math inline">\(n_{1}=\)</span> power <span class="math inline">\(_{-} 1 * 10,000\)</span>,<span class="math inline">\(n_{2}=\)</span> power <span class="math inline">\(_{-} 2 * 10,000\)</span></p>
<p>First, we know that <span class="math inline">\(n_{1} \sim b\left(10000, p_{1}\right)\)</span> and <span class="math inline">\(n_{2} \sim b\left(10000, p_{2}\right)\)</span>, where <span class="math inline">\(p_{1}\)</span> denotes the power for method 1 and <span class="math inline">\(p_{2}\)</span> denotes the power for method 2.</p>
<p>Thus, test null hypothesis <strong><span class="math inline">\(H_{0}\)</span> : <span class="math inline">\(p_{1}\)</span>=<span class="math inline">\(p_{2}\)</span></strong>.</p>
<p>Further, the two empirical power both are generated from a particular simulation setting so paired-t test is an appropriate choice to test our hypothesis.</p>
<p>Also, to test our hypothesis, we need more empirical powers for the two methods.</p>
</div>
<div id="question-7.8" class="section level2">
<h2>Question <strong>7.8</strong></h2>
<p>Refer to Exercise 7.6. Efron and Tibshirani discuss the following example. The five-dimensional scores data have a <span class="math inline">\(5 ?? 5\)</span> covariance matrix <span class="math inline">\(\Sigma\)</span>, with positive eigenvalues <span class="math inline">\(\lambda_{1}&gt;\cdots&gt;\lambda_{5}\)</span>. In principal components analysis, <span class="math display">\[
\theta=\frac{\lambda_{1}}{\sum_{j=1}^{5} \lambda_{j}}
\]</span> measures the proportion of variance explained by the first principal component. Let <span class="math inline">\(\hat{\lambda}_{1}&gt;\cdots&gt;\hat{\lambda}_{5}\)</span> be the eigenvalues of <span class="math inline">\(\hat{\Sigma}\)</span>, where <span class="math inline">\(\hat{\Sigma}\)</span> is the MLE of <span class="math inline">\(\Sigma\)</span>. Compute the sample estimate <span class="math display">\[
\hat{\theta}=\frac{\hat{\lambda}_{1}}{\sum_{j=1}^{5} \hat{\lambda}_{j}}
\]</span> of <span class="math inline">\(\theta\)</span>. Use jackknife to estimate the bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div id="answer-for-7.8" class="section level2">
<h2>Answer for <strong>7.8</strong></h2>
<ul>
<li><h3 id="basic-idea-10">Basic idea</h3></li>
</ul>
<p>The MLE of <span class="math inline">\(\Sigma\)</span> shall be deemed as the adjusted covariance matrix, saying <span class="math inline">\(\frac{\sum_{i=1}^{n}\left(x_{i}-\bar{x}\right)\left(y_{i}-\bar{y}\right)}{n}\)</span> instead of <span class="math inline">\(\frac{\sum_{i=1}^{n}\left(x_{i}-\bar{x}\right)\left(y_{i}-\bar{y}\right)}{n-1}\)</span>.</p>
<ul>
<li><h3 id="flowchart-3">Flowchart</h3></li>
</ul>
<ol style="list-style-type: decimal">
<li><p>Obtain sample size <span class="math inline">\(n\)</span> for jackknife.</p></li>
<li><p>Compute the value of <span class="math inline">\(\hat{\theta}\)</span> using given data.</p></li>
<li><p>Obtain <span class="math inline">\(\hat{\theta}_{(i)}\)</span> (<span class="math inline">\(i=1, \ldots, n\)</span>).</p></li>
<li><p>Compute the bias <span class="math inline">\(E(\hat{\theta})-\theta_{0}\)</span>.</p></li>
<li><p>Compute the standard error <span class="math inline">\(\widehat{\operatorname{var}}(\hat{\theta})\)</span>.</p></li>
</ol>
<ul>
<li><h3 id="code-9">Code</h3></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())
<span class="co"># remove variables</span>
<span class="kw">library</span>(bootstrap)
<span class="co"># to obtain data</span>
n&lt;-<span class="kw">nrow</span>(scor)
<span class="co"># sample size for jackknife</span>
theta.j&lt;-<span class="kw">numeric</span>(n)
lamda.h&lt;-<span class="kw">eigen</span>((n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">cov</span>(scor)<span class="op">/</span>n,<span class="dt">only.values=</span>T)<span class="op">$</span>values
theta.h&lt;-<span class="kw">max</span>(lamda.h)<span class="op">/</span><span class="kw">sum</span>(lamda.h)
<span class="co"># value of theta.hat</span>
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){
  y&lt;-scor[<span class="op">-</span>i,]
  x&lt;-(n<span class="op">-</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">cov</span>(y)<span class="op">/</span>(n<span class="op">-</span><span class="dv">1</span>)
  <span class="co"># MLE of sigma</span>
  lamda&lt;-<span class="kw">eigen</span>(x,<span class="dt">only.values=</span>T)<span class="op">$</span>values
  theta.j[i]&lt;-<span class="kw">max</span>(lamda)<span class="op">/</span><span class="kw">sum</span>(lamda)
}
<span class="co"># theta.hat with jackknife</span>
bias.j&lt;-(n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.j)<span class="op">-</span>theta.h)
<span class="co"># bias of theta.hat with jackknife</span>
se.j &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">mean</span>((theta.j<span class="op">-</span><span class="kw">mean</span>(theta.j))<span class="op">^</span><span class="dv">2</span>))
<span class="co"># standard error of theta.hat with jackknife</span>
c&lt;-<span class="kw">matrix</span>(<span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">original=</span>theta.h,<span class="dt">bias.jack=</span>bias.j,<span class="dt">se.jack=</span>se.j),<span class="dv">3</span>),<span class="dv">1</span>,<span class="dv">3</span>)
<span class="kw">colnames</span>(c)&lt;-<span class="kw">c</span>(<span class="st">&quot;original&quot;</span>,<span class="st">&quot;basic.jack&quot;</span>,<span class="st">&quot;se.jack&quot;</span>)
pander<span class="op">::</span><span class="kw">pandoc.table</span>(c)</code></pre></div>
<table style="width:46%;">
<colgroup>
<col width="15%"></col>
<col width="18%"></col>
<col width="12%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="center">original</th>
<th align="center">basic.jack</th>
<th align="center">se.jack</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.619</td>
<td align="center">0.001</td>
<td align="center">0.05</td>
</tr>
</tbody>
</table>
<ul>
<li><h3 id="wonder-6">Wonder</h3></li>
</ul>
<p>What can be done to reduce the bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>?</p>
</div>
<div id="question-7.10" class="section level2">
<h2>Question <strong>7.10</strong></h2>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Repeat the analysis replacing the Log-Log model with a cubic polynomial model. Which of the four models is selected by the cross validation procedure? Which model is selected according to maximum adjusted <span class="math inline">\(R^{2}\)</span> ?</p>
</div>
<div id="answer-for-7.10" class="section level2">
<h2>Answer for <strong>7.10</strong></h2>
<ul>
<li><h3 id="basic-idea-11">Basic idea</h3></li>
</ul>
<p>We want to find a suitale relationship between chemical and magnetic. The candidate models as below:</p>
<p>Linear:<span class="math inline">\(Y=\beta_{0}+\beta_{1} X+\epsilon\)</span></p>
<p>Quadratic:<span class="math inline">\(Y=\beta_{0}+\beta_{1} X+\beta_{2} X^{2}+\epsilon\)</span></p>
<p>Exponential:<span class="math inline">\(\log (Y)=\beta_{0}+\beta_{1} X+\epsilon\)</span></p>
<p>cubic polynomial:<span class="math inline">\(Y=\beta_{0}+\beta_{1} X+\beta_{2} X^{2}+\beta_{3} X^{3}+\epsilon\)</span></p>
<p>Estimate prediction error by n-fold (leave-one-out) cross validation and the adjusted <span class="math inline">\(R^{2}\)</span> for each model, select the best one according to two principle respectively.</p>
<ul>
<li><h3 id="flowchart-4">Flowchart</h3></li>
</ul>
<ol style="list-style-type: decimal">
<li><p>For <span class="math inline">\(k=1, \ldots, n\)</span>, let observation <span class="math inline">\(\left(x_{k}, y_{k}\right)\)</span> be the test point and use the remaining observations to fit the model.</p></li>
<li><p>Fit the model(s) using only the <span class="math inline">\(n-1\)</span> observations in the training set, <span class="math inline">\(\left(x_{i}, y_{i}\right)\)</span>, <span class="math inline">\(i \neq k\)</span>.</p></li>
<li><p>Compute the predicted response <span class="math inline">\(\hat{y}_{k}\)</span> for the test point.</p></li>
<li><p>Compute the prediction error <span class="math inline">\(e_{k}=y_{k}-\hat{y}_{k}\)</span>.</p></li>
<li><p>Summary the data for each model and obtain the adjusted <span class="math inline">\(R^{2}\)</span>.</p></li>
</ol>
<ul>
<li><h3 id="code-10">Code</h3></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())
<span class="co"># remove variables</span>
<span class="kw">library</span>(DAAG);<span class="kw">attach</span>(ironslag)</code></pre></div>
<pre><code>## lattice</code></pre>
<pre><code>## 
## 'lattice'</code></pre>
<pre><code>## The following object is masked from 'package:boot':
## 
##     melanoma</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic) <span class="co">#in DAAG ironslag</span>
er1 &lt;-<span class="st"> </span>er2 &lt;-<span class="st"> </span>er3 &lt;-<span class="st"> </span>er4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)
<span class="co"># for n-fold cross validation</span>
<span class="co"># fit models on leave-one-out samples</span>
<span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {
  y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span>k]
  x &lt;-<span class="st"> </span>chemical[<span class="op">-</span>k]
  J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)
  yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]
  er1[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat1
  J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))
  yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span>
  er2[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat2
  J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)
  logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]
  yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)
  er3[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat3
  J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x<span class="op">+</span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">3</span>))
  yhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">+</span>J4<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span><span class="op">+</span>J4<span class="op">$</span>coef[<span class="dv">4</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">3</span>
  er4[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat4
}
b&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">mean</span>(er1<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(er2<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(er3<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(er4<span class="op">^</span><span class="dv">2</span>)),<span class="dv">1</span>,<span class="dv">4</span>)
<span class="kw">colnames</span>(b)&lt;-<span class="kw">c</span>(<span class="st">&quot;Linear&quot;</span>,<span class="st">&quot;Quadratic&quot;</span>,<span class="st">&quot;Exponential&quot;</span>,<span class="st">&quot;Cubic polynomial model&quot;</span>)
<span class="kw">rownames</span>(b)&lt;-<span class="st">&quot;Error&quot;</span>
pander<span class="op">::</span><span class="kw">pandoc.table</span>(b)</code></pre></div>
<table style="width:99%;">
<colgroup>
<col width="16%"></col>
<col width="12%"></col>
<col width="16%"></col>
<col width="19%"></col>
<col width="33%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">Linear</th>
<th align="center">Quadratic</th>
<th align="center">Exponential</th>
<th align="center">Cubic polynomial model</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Error</strong></td>
<td align="center">19.56</td>
<td align="center">17.85</td>
<td align="center">18.44</td>
<td align="center">18.18</td>
</tr>
</tbody>
</table>
<p>As shown above, Model 2, the quadratic model, would be the best fit for the data, according to the prediction error criterion.</p>
<p>Then let us plot the predicted response with the data for each model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#par(mfrow=c(2,2))</span>
<span class="kw">data</span>(ironslag,<span class="dt">package=</span><span class="st">&quot;DAAG&quot;</span>)
a &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, .<span class="dv">1</span>) <span class="co">#sequence for plotting fits</span>
L1 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical)
<span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Linear&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)
yhat1 &lt;-<span class="st"> </span>L1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a
<span class="kw">lines</span>(a, yhat1, <span class="dt">lwd=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">L2 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>))
<span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Quadratic&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)
yhat2 &lt;-<span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a <span class="op">+</span><span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">^</span><span class="dv">2</span>
<span class="kw">lines</span>(a, yhat2, <span class="dt">lwd=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,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z6fvtjnV4ITbr9znpzNBbjgg5Mar3DFIAvI+g6zbUX3BvE+crO6fgR+xZihww5c8Qm68KgJItndnqxc2hx3P43M/MZCnQSI/rYnfTSPYATd+LQZotDmwUTHa7ac5913u2sFX/VkfoKAmJuRa11Km0Xr9mJm2nuUxeShbXRMDUdEEZO+ku988+PzUZuDx9PWtj/UFadCvGhDtX+t5mSKnH2XicaN3raebP6lT9Y/Mul6Mn7A1uu636l2nn7OJ2414XKOAs56Bov4ua9/YvrPhz5e2ho5a5oBxBy4/honTjbHLezp+0WQViAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESCgVQHyPx3GujfPA2U8uiBAuT4SJwIEtBJAtciWP+y+38qElVqmru63f9u1G3vxrmRRd3n1XWrLjQCSzyd9POx44nP3j+dI7bciof7+mSfQCRadpcibktu3AEjkxKu/++0b+bq5fxaJZN1/bzgLbfnNO5ljdxuAVJKqKG37n0yXU+mX6j/xuG4jnbU5t7uCWgegLklVA+oWYrMAUumsbSi6//eN16DTmc2oBukdtwHoHIMkIF3qESBlKRP6b6aJif7o+LRRgMTrU9X93McEpCxl5RG/1bgJQHocpEY2/HVbScaA1DhIJPa2CG8F0HpFgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESCg/wN1MUdLdRK+nAAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">L3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(magnetic) <span class="op">~</span><span class="st"> </span>chemical)
<span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Exponential&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)
logyhat3 &lt;-<span class="st"> </span>L3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a
yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)
<span class="kw">lines</span>(a, yhat3, <span class="dt">lwd=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAArlBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kNtmAABmADpmOgBmOjpmkJBmkLZmkNtmtrZmtttmtv+QOgCQZjqQkLaQtpCQttuQ29uQ2/+2ZgC2Zjq2ZpC2kGa225C227a229u22/+2/9u2///bkDrbtmbbtpDb27bb2//b/7bb////tmb/25D/27b//7b//9v///8nPoH5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAALjklEQVR4nO2dC5urthGG2c226yZpUztpc9lNky69JkuT9uBj+///seqCQBhJnyQkEPZ8z7NeDGOBXkszAsaiupCcqtY+gNJFgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESCgZQE1ldJvPqQq8/z398v5dVzg9fsZ2jygj189EiCX6ooButaGAQ21Oe4q+d2zV1bLf/2pqp5+Elt+YYuffP1B2D/89W9s/RtffWZLD3+8Wl1z2o8/SyC/fMXe/P7tRgDx5rTnLy9dNZke3i59M+M1bLT1p4NYfHofrdYBtf3aDQNSehFf88MPO1ETVs3Hny7/qapn0bLYKkGPv7JWJZdrbsI2Tld3Poi9/PaDtLgNQLwuXaOp5Yq6627valm2L2b3zBvQ/tK1QW21Bojv4Nd/fMYp3wgg0T/2ckFAYb7lTdWNL8sXzuZZ0ux6kLZaB3T+XlpsGtAo5LQ72YAUIOZEXmS15bJOoq0QIPZSPf3l18PtAOI1khXxa0EvQzEmQNI/nW4IEOtwn8k+ZvdBPQnVsuQHTYBa5ZluwkmzWvFw9b+DqKs9iukkHr67fDzIjcPqpg/r4oMfXzfugwZAPMq/cdfyPIyDuo6mjYMGEt04iK/QV7f9OEj02M076QFQq/Uu1k9+ZiHoC20k/Y20H0hcPn6/60z01Xx8/fTvPoo9/dhI+NsEZJPxhKoMESAgAgREgIDKAFSwCBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgoDBAKj+g2LtY6RUEqJEJczylYp/jYEpUCKDza4+lSfdTgsIVAuh06JPg2rvpZIlbULUZ5QDEfFDXhKw+qPyg2LHJA0ilwdnTt4oHpFpPJkBLF5dcff9aGFB4115JywA67l5sm+4bkPJAXJYwXzqgzD6oC14bbkH5oxiPX5sG1CmbD6of3giQU+yElQA5ddx9QoCcOr9WBCj7ftcWAQK6F0DRJzd3Aij+9O8+AM04QSZA6KPJDVcpDu2NAKHdkQ9C+9tIFNvMFcVe99KCokWAgGIA1WISp3k33YvwQT49PQJQLW52nQ7PduOQ4haR0e15+cJwQOrG+7y77gWMg/yiRTggdeO9IUAWw6abV2yWE1oJkA4kGyBtzrV4reODxkS8+GQK8zAFb5Uodt1mIJ+QEW1g+gtKwVtlHBQ6iA+yDqmRTwJVQHHJFAYo6t786bDvb7zbo5hHCt46I+lAPuKfd9kBx1FqCwo4qe9JRgwUv5TxyzVQ3FgKnnGIpBa9C1ELCpBzoLipFLxJxxtFOu9S5D81T19VzTtbLQiQIfhrRxffguYcTFEXzMYHdH1wOa8HtY7xdqmApu7Iu5hh8cSnAa2dPYz1xP3xDx/0gB+53wU08DE07QhA7cMbC95sRGQ35peMajmtellh3iw15DF1/bjLHbzajigm2s3xdxxQKQPFK8di8IEWzxh3wYwDcoyDZOs6//dSTAvCp/G22BHfgmrHD5361mXtiGteMDOwsEfXaB/U2LPHmBoZvlqrUVGAxLt0gOQweVMXzJyAuuWEgFKoHB80ivEpfFAaFRLFrlEZPui9h34pyS+aVx0HVXqvQrbehfZLdYqfoa4JSHkbr1PCmHFQil96FwDIB0/sQHG+FgNkCkzXfFyoYgaKs27Kh+537n6MoXs6DLIeT8xA0TlEDC4uq4xdyTAOshOK6WJVfBQL6v4JZNiZqYMlBZRGawGqpl/RXQMyD6Hz+iDtF7szfNEaUWwAMe119s9776hfkve6Wv4ItPgRUQ5ATs8W6/jiwzy/5BE/900GQE5PEh0X4geK7eP7jCy89IAcvnZO2Iy7osjFW9BygHANe0Bj07mjijk+aM6YOvCIPSqpSBji1pzmGn1FkT9k0N6AEmeYeTUDjY/r8nOg8oyDUmeY+dVzGOPo1whLBJQ8P+i6no5xjO6KNEDRlCIAqZHikhlmBsfi3qjW6bTCdhl6oNoVRRa+nl3zcuTIMDM2EuNbcyeLJhR3RbHlt55dNw7TZZgZ6uUDaOyRQBd17j/YkPef46fv4s+qZBlmpm/eCWjct8yAQppT3ECRJ1E5AaXar7Fv2AFN+pbRBwV1uIimxsfP9T5uEtJQfxAEaNKQtPA16YMZAV1q8cRp52kGf9KucEO2s5EkgLTOdG3ogpAdEBbPXZC/uJsJyHnRXW2zEwop1GbraRcxUDy/OtKsEkSxq65lIBRSqNU03NB/oFjbT/hnjf4Nso62A1jMO1AtikHv3A8U6+elAE1a0FU3jN9ZsKHPnVWFxe7L5x30iMh1UxpMpp4pYl/Bhtp5hF1qKH1+DQfkUaFR1UsD1KWvzpTTgXpePRy9KQnQTu41T34QrtLEwOhuxt0ww4FaDTMnL4AqGbdWpoBVmUJbwgO1GmZOf+mrNK61Vl1YtOXyWeIDtRp6OekZ+x13GP2fX2Mw9bRlL5hldtKmCzkBzvbacm5Pi+liVU4nrbb78DHV2Wi6KKA0SgHIBu0uAFlOuAwWxg96rUxzoMGG7lL83UksIHPAiuVTaAvqicQASqsCAY0q3i0m7jcBKgzQtK1UjjC9AJ91AV1V0N5nlulNRq0JSK+023ffJ6C+1h6BbTU+BQDyax1r8SkCUMjHFueUCZBXhll4v1mhp+UB5JlhFsVnYUJZAOWagepmAOWaw+xmAGWbw+yGfFCmOcysA+244nz2mNxQaNE5zLK2q8JOVqOKyuqZyr1gFlpmugLHpSc3XLw4AgTL2pwPWvo5q9uLYtasl7ji1lS2k1WQ4VBtRnkAeU7P4FNoIptUu8rz4TmFEqBlbAjQQrvK8+E5hRKgZWwI0EK7yvPhOYUSoGVstgnolkSAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBAqQF1s+u4HrHV2cjbkMbbSCIVcu8spzdxFMPnYlFPSol+YEhiQKeDuLXYssNpbYfU2dh/4Xh+ZR9teKWt5Qwmjh9K8nkQxKedhwOUFlAr70nLVLTa/LV2No6nLMl51Fj17OX0Jo5ixKS9/Fan83CQkgJqq7043uHw7TaXBhww+8pd5XQmqBgOCBXjVGofJAE5n0HWbag/r5xPnKwf30E5Ys5QUAyf8ggV41QWQLK/W3u9sDkdeB6f/YmBPA0SlcNM3MW0gh0oxq3VAE0Wr2yUj7aX0w6xy946+Kw/5QHy6mJCtnktZRqtsxw909YxPSZ3ZcV1MeAVdUDmIN395sFVTqM7HkesZ2WU56RBXNUgmr/WYZoiaznKxFFMv6mcMH9Rh+oemXVRjB+w0bsed2qttZzBxF6MeFyjgFPOQLH/LhvX2L6z4c+XNrqORuaA8QJs5Wgm1mK0Tc7DcYtOVoEIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAioKkPvpMMataR4o49CGAKX6SJgIEFAhgBqRLX86/HknE1Yambp63H17YAtHsVayaLq8+i615U4AyeeT7k8Hnvjc/fEcqeNOJNQ/vvMEOsGisxR5U3L5HgCJnHj1/7h7ke/bx3eRSNa9vHAWveWXbzLH7j4AqSRVUVv2ItPlVPqlehGP69bSWduh32VUGYC6JNUeUDcRmwGQSmdlrujxn3fegi4Dm0kL6jfcB6DBB0lAfa0ngJSlTOi/my4m4tH59VkBEu8vdfdzHx2QspSNR/xW4y4A9eMgNbLh71kjmQJS4yCR2MsQ3gugckWAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERIKD/A6bRkEWwzzXjAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">L4 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">3</span>))
<span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Cubic polynomial model&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)
yhat4 &lt;-<span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a <span class="op">+</span><span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">^</span><span class="dv">2</span><span class="op">+</span>L4<span class="op">$</span>coef[<span class="dv">4</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">^</span><span class="dv">3</span>
<span class="kw">lines</span>(a, yhat4, <span class="dt">lwd=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Now obtain the adjusted <span class="math inline">\(R^{2}\)</span> for each model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">AR&lt;-<span class="kw">numeric</span>(<span class="dv">4</span>)
AR[<span class="dv">1</span>]&lt;-<span class="kw">summary</span>(L1)[<span class="dv">9</span>]
AR[<span class="dv">2</span>]&lt;-<span class="kw">summary</span>(L2)[<span class="dv">9</span>]
AR[<span class="dv">3</span>]&lt;-<span class="kw">summary</span>(L3)[<span class="dv">9</span>]
AR[<span class="dv">4</span>]&lt;-<span class="kw">summary</span>(L4)[<span class="dv">9</span>]
ajust_R2&lt;-<span class="kw">round</span>(<span class="kw">as.numeric</span>(AR),<span class="dv">3</span>)
c&lt;-<span class="kw">matrix</span>(ajust_R2,<span class="dv">1</span>,<span class="dv">4</span>)
<span class="kw">colnames</span>(c)&lt;-<span class="kw">c</span>(<span class="st">&quot;Linear&quot;</span>,<span class="st">&quot;Quadratic&quot;</span>,<span class="st">&quot;Exponential&quot;</span>,<span class="st">&quot;Cubic polynomial model&quot;</span>)
<span class="kw">rownames</span>(c)&lt;-<span class="st">&quot;adj.r.squared&quot;</span>
pander<span class="op">::</span><span class="kw">pandoc.table</span>(c)</code></pre></div>
<table>
<colgroup>
<col width="25%"></col>
<col width="11%"></col>
<col width="15%"></col>
<col width="17%"></col>
<col width="30%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">Linear</th>
<th align="center">Quadratic</th>
<th align="center">Exponential</th>
<th align="center">Cubic polynomial model</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>adj.r.squared</strong></td>
<td align="center">0.528</td>
<td align="center">0.577</td>
<td align="center">0.528</td>
<td align="center">0.574</td>
</tr>
</tbody>
</table>
<p>According to the maximum adjusted <span class="math inline">\(R^{2}\)</span> criterion, the quadratic model, would also be the best fit for the data.</p>
</div>
<div id="question-8.3" class="section level2">
<h2>Question <strong>8.3</strong></h2>
<p>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
</div>
<div id="answer-for-8.3" class="section level2">
<h2>Answer for <strong>8.3</strong></h2>
<ul>
<li><h3 id="basic-idea-12">Basic idea</h3></li>
</ul>
<p>Here is a test of equal variance. <span class="math display">\[
H_{0}: \sigma_{1}^{2}=\sigma_{2}^{2} \text { vs } H_{a}: \sigma_{1}^{2} \neq \sigma_{2}^{2}
\]</span> For testing the equality of variance of two sample, an observation is considered <span class="math inline">\(extreme\)</span> if it is not within the range of the other sample. We will implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal. At the same time, since Ball could be more powerful for non-location family distribution, it will be performed for comparison.</p>
<ul>
<li><h3 id="flowchart-5">Flowchart</h3></li>
</ul>
<ol style="list-style-type: decimal">
<li><p>Set two different sample sizes.</p></li>
<li><p>Set two different variances.</p></li>
<li><p>Write a function to obtain maximum number of extreme points which can be used in function <span class="math inline">\(boot\)</span>.</p></li>
<li><p>Write a function to obtain p-value of permutation test.</p></li>
<li><p>Use Monte Carlo method to obtain p-values of the two test under two sorts of condition, saying <span class="math inline">\(H_{0}\)</span> is ture and <span class="math inline">\(H_{0}\)</span> is false, respectively.</p></li>
</ol>
<ul>
<li><h3 id="code-11">Code</h3></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())
<span class="co"># remove variables</span>
<span class="kw">library</span>(boot);<span class="kw">library</span>(Ball)
<span class="co"># to obtain function</span>
<span class="kw">set.seed</span>(<span class="dv">234</span>)
m&lt;-<span class="fl">1e3</span>;R&lt;-<span class="dv">999</span>
n1&lt;-<span class="dv">20</span>;n2&lt;-<span class="dv">30</span>
<span class="co"># different sample sizes</span>
N&lt;-<span class="kw">c</span>(n1,n2)
mu1&lt;-mu2&lt;-<span class="dv">0</span>
sigma1&lt;-sigma2&lt;-<span class="dv">1</span>
<span class="co"># equal variance</span>
sigma3&lt;-<span class="dv">2</span>
<span class="co"># unequal variance</span>
Tn &lt;-<span class="st"> </span><span class="cf">function</span>(d,ix,sizes){
  n1&lt;-sizes[<span class="dv">1</span>];n2&lt;-sizes[<span class="dv">2</span>]
  n&lt;-n1<span class="op">+</span>n2
  ii&lt;-ix[<span class="dv">1</span><span class="op">:</span>n1];jj&lt;-ix[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n]
  outx&lt;-<span class="kw">sum</span>(d[ii]<span class="op">&gt;</span><span class="kw">max</span>(d[jj]))<span class="op">+</span><span class="kw">sum</span>(d[ii]<span class="op">&lt;</span><span class="kw">min</span>(d[jj]))
  outy&lt;-<span class="kw">sum</span>(d[jj]<span class="op">&gt;</span><span class="kw">max</span>(d[ii]))<span class="op">+</span><span class="kw">sum</span>(d[jj]<span class="op">&lt;</span><span class="kw">min</span>(d[ii]))
  <span class="kw">return</span>(<span class="kw">max</span>(outx,outy))
}
<span class="co"># function to obtain maximum number of extreme points</span>
myeq.test&lt;-<span class="cf">function</span>(d){
  boot.obj&lt;-<span class="kw">boot</span>(<span class="dt">data=</span>d,<span class="dt">R=</span>R,<span class="dt">statistic=</span>Tn,<span class="dt">sim=</span><span class="st">&quot;permutation&quot;</span>,<span class="dt">sizes=</span>N)
  ts&lt;-<span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)
  p.value&lt;-<span class="kw">mean</span>(ts <span class="op">&gt;=</span><span class="st"> </span>ts[<span class="dv">1</span>])
  <span class="kw">return</span>(p.value)
}
<span class="co"># function to obtain p.value of permutation test</span>
p.values&lt;-<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">4</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
  x&lt;-<span class="kw">rnorm</span>(n1,mu1,sigma1)
  y&lt;-<span class="kw">rnorm</span>(n2,mu2,sigma2)
  z&lt;-<span class="kw">rnorm</span>(n2,mu2,sigma3)
  d1&lt;-<span class="kw">c</span>(x,y);d2&lt;-<span class="kw">c</span>(x,z)
  p.values[i,<span class="dv">1</span>]&lt;-<span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">123</span>)<span class="op">$</span>p.value
  <span class="co"># p.value of Ball test with H0 being TURE </span>
  p.values[i,<span class="dv">2</span>]&lt;-<span class="kw">myeq.test</span>(d1)
  <span class="co"># p.value of permutation test with H0 being TURE </span>
  p.values[i,<span class="dv">3</span>]&lt;-<span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>z,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">123</span>)<span class="op">$</span>p.value
  <span class="co"># p.value of Ball test with H0 being FALSE</span>
  p.values[i,<span class="dv">4</span>]&lt;-<span class="kw">myeq.test</span>(d2)
  <span class="co"># p.value of permutation test with H0 being FALSE</span>
}
c&lt;-<span class="kw">matrix</span>(<span class="kw">colMeans</span>(p.values),<span class="dv">1</span>,<span class="dv">4</span>)
<span class="kw">colnames</span>(c)&lt;-<span class="kw">c</span>(<span class="st">&quot;bd.test(H0=T)&quot;</span>,<span class="st">&quot;myeq.test(H0=T)&quot;</span>,<span class="st">&quot;bd.test(H0=F)&quot;</span>,<span class="st">&quot;myeq.test(H0=F)&quot;</span>)
<span class="kw">rownames</span>(c)&lt;-<span class="st">&quot;p.value&quot;</span>
pander<span class="op">::</span><span class="kw">pandoc.table</span>(c)</code></pre></div>
<table>
<colgroup>
<col width="17%"></col>
<col width="19%"></col>
<col width="22%"></col>
<col width="19%"></col>
<col width="20%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">bd.test(H0=T)</th>
<th align="center">myeq.test(H0=T)</th>
<th align="center">bd.test(H0=F)</th>
<th align="center">myeq.test(H0=F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>p.value</strong></td>
<td align="center">0.5118</td>
<td align="center">0.5697</td>
<td align="center">0.09126</td>
<td align="center">0.04512</td>
</tr>
</tbody>
</table>
<p>As is shown above, under the circumstances of equal variance, both Ball-test and permutation-test can not reject the null hypothesis, while permutaion-test being more likely to accept <span class="math inline">\(H_{0}\)</span>. Nevertheless, when the null hypothesis was false, neither Ball nor permutation test would perform very well but the latter would show a smaller p-value.</p>
<ul>
<li><h3 id="wonder-7">Wonder</h3></li>
</ul>
<p>Perform one permutation test to observe p-value more intuitively.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">111</span>)
ox&lt;-<span class="kw">rnorm</span>(n1,mu1,sigma1)
oy&lt;-<span class="kw">rnorm</span>(n2,mu2,sigma2)
od&lt;-<span class="kw">c</span>(ox,oy)
obj.o&lt;-<span class="kw">boot</span>(<span class="dt">data=</span>od,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">statistic=</span>Tn,<span class="dt">sim=</span><span class="st">&quot;permutation&quot;</span>,<span class="dt">sizes=</span>N)
tb &lt;-<span class="st"> </span><span class="kw">c</span>(obj.o<span class="op">$</span>t,obj.o<span class="op">$</span>t0)
<span class="kw">hist</span>(tb, <span class="dt">freq=</span><span class="ot">FALSE</span>, <span class="dt">main=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;replicates of maximum number of extreme points&quot;</span>)
<span class="kw">abline</span>(<span class="dt">v=</span>obj.o<span class="op">$</span>t0,<span class="dt">col=</span><span class="st">'red'</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can observe the original number of extreme points is 4&lt;5, which is consistent with the result under Count 5 criterion.</p>
</div>
<div id="question-sides" class="section level2">
<h2>Question <strong>sides</strong></h2>
<p>Power comparison (distance correlation test versus ball covariance test)</p>
<p>Model 1:<span class="math inline">\(Y=X / 4+e\)</span></p>
<p>Model 2:<span class="math inline">\(Y=X / 4 \times e\)</span></p>
<p><span class="math inline">\(x \sim N\left(0_{2}, l_{2}\right), e \sim N\left(0_{2}, l_{2}\right), X\)</span> and <span class="math inline">\(e\)</span> are independent</p>
</div>
<div id="answer-for-sides" class="section level2">
<h2>Answer for <strong>sides</strong></h2>
<ul>
<li><h3 id="flowchart-6">Flowchart</h3></li>
</ul>
<ol style="list-style-type: decimal">
<li><p>Set number of p-value M for power.</p></li>
<li><p>Set sample size sequence.</p></li>
<li><p>For <span class="math inline">\(\dot{l}^{t h}\)</span> p-values With <span class="math inline">\(j^{t h}\)</span> sample size n, obtain <span class="math inline">\(x\)</span> <span class="math inline">\(e\)</span> from <span class="math inline">\(\ N\left(0_{2}, l_{2}\right)\)</span> independently.</p></li>
<li><p>Compute <span class="math inline">\(y_{1}\)</span> <span class="math inline">\(y_{2}\)</span> with two models.</p></li>
<li><p>Obtain <span class="math inline">\(\dot{l}^{t h}\)</span> p-values of two models using two sorts of test.</p></li>
<li><p>Obtain <span class="math inline">\(j^{t h}\)</span> power with <span class="math inline">\(j^{t h}\)</span> sample size.</p></li>
</ol>
<ul>
<li><h3 id="code-12">Code</h3></li>
</ul>
<p>I am so sorry for the awful answer. I have tried my best but my laptop can not run smoothly and I cannot figure whats wrong with my second answer.So I put my procedure in the comment line. If you were so kind to debug my procedure, I would appreciate it very well. Apologize again.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#rm(list=ls())</span>
## remove variables
<span class="co">#library(Ball);library(MASS);library(boot)</span>
<span class="co">#par(mfrow=c(1,2))</span>
##set.seed(123)
<span class="co">#M&lt;-100</span>
##sample size for power
<span class="co">#alpha &lt;- 0.1</span>
<span class="co">#sigma&lt;-matrix(c(1,0,0,1),2,2)</span>
<span class="co">#dCov &lt;- function(x, y){</span>
<span class="co">#  x &lt;- as.matrix(x)</span>
<span class="co">#  y &lt;- as.matrix(y)</span>
<span class="co">#  n &lt;- nrow(x)</span>
<span class="co">#  m &lt;- nrow(y)</span>
<span class="co">#  if (n != m || n &lt; 2) stop(&quot;Sample sizes must agree&quot;)</span>
<span class="co">#  if (! (all(is.finite(c(x, y)))))</span>
<span class="co">#  stop(&quot;Data contains missing or infinite values&quot;)</span>
<span class="co">#  Akl &lt;- function(x) {</span>
<span class="co">#    d &lt;- as.matrix(dist(x))</span>
<span class="co">#    m &lt;- rowMeans(d)</span>
<span class="co">#    M &lt;- mean(d)</span>
<span class="co">#    a &lt;- sweep(d, 1, m)</span>
<span class="co">#    b &lt;- sweep(a, 2, m)</span>
<span class="co">#    return(b + M)</span>
<span class="co">#  }</span>
<span class="co">#  A&lt;-Akl(x)</span>
<span class="co">#  B&lt;-Akl(y)</span>
<span class="co">#  dCov&lt;-sqrt(mean(A*B))</span>
<span class="co">#  dCov</span>
<span class="co">#}</span>
<span class="co">#ndcov2 &lt;- function(z, ix, dims) {</span>
##dims contains dimensions of x and y
<span class="co">#p &lt;- dims[1]</span>
<span class="co">#q1 &lt;- dims[2] + 1</span>
<span class="co">#d &lt;- p + dims[2]</span>
<span class="co">#x &lt;- z[ , 1:p] #leave x as is</span>
<span class="co">#y &lt;- z[ix, q1:d] #permute rows of y</span>
<span class="co">#return(nrow(z) * (dCov(x,y))^2)</span>
<span class="co">#}</span>
<span class="co">#size&lt;-seq(10,205,by=5)</span>
## sample size sequence
<span class="co">#for(j in 1:40){</span>
<span class="co">#  n&lt;-size[j]</span>
<span class="co">#  pow&lt;-matrix(NA,40,4)</span>
<span class="co">#  p.values&lt;-matrix(NA,M,4)</span>
<span class="co">#  for(i in 1:M){</span>
<span class="co">#    set.seed(i*j*321)</span>
<span class="co">#    x&lt;-mvrnorm(n,rep(0,2),sigma)</span>
<span class="co">#    e&lt;-mvrnorm(n,rep(0,2),sigma)</span>
<span class="co">#    y1&lt;-x/4+e</span>
<span class="co">#    y2&lt;-x/4*e</span>
<span class="co">#    p.values[i,1]&lt;-bcov.test(x=x,y=y1,R=10,seed=i*121)$p.value</span>
<span class="co">#    # p-value of Ball correlation test of model 1</span>
<span class="co">#    m1&lt;-matrix(cbind(x,y1),n,4)</span>
<span class="co">#    boot.o1&lt;-boot(data=m1,statistic=ndcov2,R=99,sim=&quot;permutation&quot;,dims=c(2,2))</span>
<span class="co">#    t.b1&lt;-c(boot.o1$t0,boot.o1$t)</span>
<span class="co">#    p.values[i,2]&lt;-mean(t.b1&gt;=t.b1[1])</span>
<span class="co">#    # p-value of distance correlation test of model 1</span>
<span class="co">#    p.values[i,3]&lt;-bcov.test(x=x,y=y2,R=99,seed=i*123)$p.value</span>
<span class="co">#    # p-value of Ball correlation test of model 2</span>
<span class="co">#    m2&lt;-matrix(cbind(x,y2),n,4)</span>
<span class="co">#    boot.o2&lt;-boot(data=m2,statistic=ndcov2,R=99,sim=&quot;permutation&quot;,dims=c(2,2))</span>
<span class="co">#    t.b2&lt;-c(boot.o2$t0,boot.o2$t)</span>
<span class="co">#    p.values[i,4]&lt;-mean(t.b2&gt;=t.b2[1])</span>
<span class="co">#    # p-value of distance correlation test of model 2</span>
<span class="co">#  }</span>
<span class="co">#  pow[j,] &lt;- colMeans(p.values&lt;alpha)</span>
<span class="co">#}</span>
<span class="co">#plot(size,pow[,1], type = &quot;l&quot;, xlab = &quot;n&quot;, ylim = c(0,1),ylab=&quot;power&quot;,main=&quot;Model 1&quot;)</span>
<span class="co">#  lines(size,pow[,2],lty=2)</span>
<span class="co">#  legend(&quot;topleft&quot;,1,c(&quot;Ball&quot;,&quot;dCov&quot;),lty=c(1,2),inset=.02)</span>
<span class="co">#plot(size,pow[,3], type = &quot;l&quot;, xlab = &quot;n&quot;, ylim = c(0,1),ylab=&quot;power&quot;,main=&quot;Model 2&quot;)</span>
<span class="co">#lines(size,pow[,4],lty=2)</span>
<span class="co">#legend(&quot;topleft&quot;,1,c(&quot;Ball&quot;,&quot;dCov&quot;),lty=c(1,2),inset=.02)</span></code></pre></div>
</div>
<div id="question-9.4" class="section level2">
<h2>Question <strong>9.4</strong></h2>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
</div>
<div id="answer-for-9.4" class="section level2">
<h2>Answer for <strong>9.4</strong></h2>
<ul>
<li><h3 id="basic-idea-13">Basic idea</h3></li>
</ul>
<p>Markov Chain Monte Carlo methods estimate the integral by Monte Carlo integration, and the Markov Chain provides the sampler that generates the random observations from the target distribution, saying the standard Laplace distribution here.</p>
<p>The standard Laplace distribution has density <span class="math display">\[
f(x)=\frac{1}{2} e^{-|x|}, x \in \mathbb{R}
\]</span></p>
<p>We choose a symmetric proposal distribution as <span class="math inline">\(N\left(X_{t}, \sigma^{2}\right)\)</span>, in that the generated chain from it is able to converge to the standard Laplace distribution and enjoy irreducibility, positive recurrence, and aperiodicity.</p>
<ul>
<li><h3 id="flowchart-7">Flowchart</h3></li>
</ul>
<ol style="list-style-type: decimal">
<li><p>Generate <span class="math inline">\(Y\)</span> from <span class="math inline">\(N\left(X_{t}, \sigma^{2}\right)\)</span>.</p></li>
<li><p>Given initial value <span class="math inline">\(X_{0}\)</span>.</p></li>
<li><p>Generate <span class="math inline">\(U\)</span> from Uniform(0,1).</p></li>
<li><p>If <span class="math display">\[
U \leq \frac{f(Y)}{f\left(X_{t}\right)}
\]</span></p></li>
</ol>
<p>accept <span class="math inline">\(Y\)</span> and set <span class="math inline">\(X_{t+1}=Y\)</span> ; otherwise set <span class="math inline">\(X_{t+1}=X_{t}\)</span>.</p>
<ol start="5" style="list-style-type: decimal">
<li><p>Increment <span class="math inline">\(t\)</span> until the chain has converged to a stationary distribution.</p></li>
<li><p>Repeating the simulation with different choices of <span class="math inline">\(\sigma\)</span></p></li>
</ol>
<ul>
<li><h3 id="code-13">Code</h3></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())
<span class="co"># remove variables</span>
<span class="kw">library</span>(GeneralizedHyperbolic)
<span class="co"># to obtain function</span>
<span class="kw">set.seed</span>(<span class="dv">123</span>)
N &lt;-<span class="st"> </span><span class="dv">2000</span>
<span class="co"># iteration time</span>
sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, .<span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">16</span>)
<span class="co"># different choices of sigma</span>
x0&lt;-<span class="dv">25</span>
<span class="co"># initial setting</span>
myrw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(a, x0, N) {
  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)
  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0
  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)
  k &lt;-<span class="st"> </span><span class="dv">0</span>
  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {
    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="op">-</span><span class="dv">1</span>], a)
    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">dskewlap</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">dskewlap</span>(x[i<span class="op">-</span><span class="dv">1</span>])))
      x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {
        x[i] &lt;-<span class="st"> </span>x[i<span class="op">-</span><span class="dv">1</span>]
        k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
      }
  }
  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))
}
<span class="co"># function to generate the chain</span>
r1 &lt;-<span class="st"> </span><span class="kw">myrw.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N)
r2 &lt;-<span class="st"> </span><span class="kw">myrw.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N)
r3 &lt;-<span class="st"> </span><span class="kw">myrw.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)
r4 &lt;-<span class="st"> </span><span class="kw">myrw.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N)
c&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(r1<span class="op">$</span>k<span class="op">/</span>N, r2<span class="op">$</span>k<span class="op">/</span>N, r3<span class="op">$</span>k<span class="op">/</span>N, r4<span class="op">$</span>k<span class="op">/</span>N),<span class="dv">1</span>,<span class="dv">4</span>)
<span class="kw">colnames</span>(c)&lt;-<span class="kw">c</span>(<span class="st">&quot;sigma=0.05&quot;</span>,<span class="st">&quot;sigma=0.5&quot;</span>,<span class="st">&quot;sigma=2&quot;</span>,<span class="st">&quot;sigma=16&quot;</span>)
<span class="kw">rownames</span>(c)&lt;-<span class="st">&quot;rejection rate&quot;</span>
pander<span class="op">::</span><span class="kw">pandoc.table</span>(c)</code></pre></div>
<table style="width:92%;">
<colgroup>
<col width="29%"></col>
<col width="18%"></col>
<col width="16%"></col>
<col width="13%"></col>
<col width="13%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">sigma=0.05</th>
<th align="center">sigma=0.5</th>
<th align="center">sigma=2</th>
<th align="center">sigma=16</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>rejection rate</strong></td>
<td align="center">0.016</td>
<td align="center">0.1685</td>
<td align="center">0.472</td>
<td align="center">0.905</td>
</tr>
</tbody>
</table>
<p>As we can observe in the table, both the second and third chain have a rejection rate in the range [0.15, 0.5].</p>
<p>Then we will show what can happen to the random walk Metropolis sampler when the variance of proposal distribution change.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#par(mfrow=c(2,2))</span>
<span class="kw">plot</span>(r1<span class="op">$</span>x,<span class="dt">type=</span><span class="st">'l'</span>,<span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>,<span class="dt">xlab=</span><span class="kw">expression</span>(<span class="kw">paste</span>(sigma,<span class="st">'=0.05'</span>)))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># generated sample vs the time index when the variance of proposal distribution is 0.05</span>
<span class="kw">plot</span>(r2<span class="op">$</span>x,<span class="dt">type=</span><span class="st">'l'</span>,<span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>,<span class="dt">xlab=</span><span class="kw">expression</span>(<span class="kw">paste</span>(sigma,<span class="st">'=0.5'</span>)))
<span class="co"># generated sample vs the time index when the variance of proposal distribution is 0.5</span>
 <span class="kw">abline</span>(<span class="dt">h=</span><span class="op">-</span><span class="dv">3</span>,<span class="dt">col=</span><span class="st">'red'</span>,<span class="dt">lwd=</span>.<span class="dv">3</span>)
 <span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">3</span>,<span class="dt">col=</span><span class="st">'red'</span>,<span class="dt">lwd=</span>.<span class="dv">3</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="co"># convergence range</span>
<span class="kw">plot</span>(r3<span class="op">$</span>x,<span class="dt">type=</span><span class="st">'l'</span>,<span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>,<span class="dt">xlab=</span><span class="kw">expression</span>(<span class="kw">paste</span>(sigma,<span class="st">'=2'</span>)))
<span class="co"># generated sample vs the time index when the variance of proposal distribution is 4</span>
<span class="kw">abline</span>(<span class="dt">h=</span><span class="op">-</span><span class="dv">3</span>,<span class="dt">col=</span><span class="st">'red'</span>,<span class="dt">lwd=</span>.<span class="dv">3</span>)
<span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">3</span>,<span class="dt">col=</span><span class="st">'red'</span>,<span class="dt">lwd=</span>.<span class="dv">3</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># convergence range</span>
<span class="kw">plot</span>(r4<span class="op">$</span>x,<span class="dt">type=</span><span class="st">'l'</span>,<span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>,<span class="dt">xlab=</span><span class="kw">expression</span>(<span class="kw">paste</span>(sigma,<span class="st">'=16'</span>)))
<span class="co"># generated sample vs the time index when the variance of proposal distribution is 16</span>
<span class="kw">abline</span>(<span class="dt">h=</span><span class="op">-</span><span class="dv">3</span>,<span class="dt">col=</span><span class="st">'red'</span>,<span class="dt">lwd=</span>.<span class="dv">3</span>)
<span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">3</span>,<span class="dt">col=</span><span class="st">'red'</span>,<span class="dt">lwd=</span>.<span class="dv">3</span>)<span class="co"># convergence range </span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As is shown above, under the circumstances of proposal distribution with <span class="math inline">\(N\left(X_{t}, 0.05^{2}\right)\)</span>, Chain 1 has not converged to the target in 2000 iterations. The chain in second(<span class="math inline">\(\sigma=0.5\)</span>) and third(<span class="math inline">\(\sigma=2\)</span>) plot converging to the target distribution while the former requires a little longer burn-in period. Finally, in the fourth plot, where <span class="math inline">\(\sigma\)</span>= 16, most of the candidate points are rejected. The fourth chain converges, but it is inefficient.</p>
<ul>
<li><h3 id="wonder-8">Wonder</h3></li>
</ul>
<p>We want to observe the relationship between generated sample and the target distribution in a more intuitive way. So the QQ plot and histogram of the generated sample with <span class="math inline">\(N\left(X_{t}, 0.5^{2}\right)\)</span> and <span class="math inline">\(N\left(X_{t}, 2^{2}\right)\)</span> density superimposed are shown below respectively.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#par(mfrow=c(2,2))</span>
b &lt;-<span class="st"> </span><span class="dv">201</span> ; d&lt;-<span class="dv">101</span>
<span class="co">#discard the burnin sample</span>
y1 &lt;-<span class="st"> </span>r2<span class="op">$</span>x[b<span class="op">:</span>N]
y2 &lt;-<span class="st"> </span>r3<span class="op">$</span>x[d<span class="op">:</span>N]
a &lt;-<span class="st"> </span><span class="kw">ppoints</span>(<span class="dv">100</span>)
QR &lt;-<span class="st"> </span><span class="kw">qskewlap</span>(<span class="dv">1</span><span class="op">-</span>a) 
<span class="co"># quantiles of Rayleigh</span>
Q1 &lt;-<span class="st"> </span><span class="kw">quantile</span>(y1, a)
Q2 &lt;-<span class="st"> </span><span class="kw">quantile</span>(y2, a)
<span class="kw">qqplot</span>(QR, Q1, <span class="dt">main=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;standard Laplace distibution&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Sample Quantiles&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(y1, <span class="dt">breaks=</span><span class="st">&quot;scott&quot;</span>, <span class="dt">main=</span><span class="st">&quot;&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">freq=</span><span class="ot">FALSE</span>)
<span class="kw">lines</span>(QR, <span class="kw">dskewlap</span>(QR))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qqplot</span>(QR, Q2, <span class="dt">main=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;standard Laplace distibution&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Sample Quantiles&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(y2, <span class="dt">breaks=</span><span class="st">&quot;scott&quot;</span>, <span class="dt">main=</span><span class="st">&quot;&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">freq=</span><span class="ot">FALSE</span>)
<span class="kw">lines</span>(QR, <span class="kw">dskewlap</span>(QR))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-11.1" class="section level2">
<h2>Question <strong>11.1</strong></h2>
<p>The natural logarithm and exponential functions are inverses of each other, so that mathematically <span class="math inline">\(\log (\exp x)=\exp (\log x)=x\)</span>. Show by example that this property does not hold exactly in computer arithmetic. Does the identity hold with near equality? (See all.equal.)</p>
</div>
<div id="answer-for-11.1" class="section level2">
<h2>Answer for <strong>11.1</strong></h2>
<ul>
<li><h3 id="basic-idea-14">Basic idea</h3></li>
</ul>
<p>It is well known that there are fundamental differences between mathematical calculations and computer calculations. Mathematical ideas such as limit, supremum, infimum, etc. cannot be exactly reproduced in the computer. Therefore, inverse transformation can not obtain the original result.</p>
<ul>
<li><h3 id="flowchart-8">Flowchart</h3></li>
</ul>
<ol style="list-style-type: decimal">
<li><p>Set the value of <span class="math inline">\(x\)</span>.</p></li>
<li><p>Compute <span class="math inline">\(\log \left(e^{x}\right)\)</span>.</p></li>
<li><p>Compute <span class="math inline">\(e^{\log (x)}\)</span>.</p></li>
<li><p>Compare the two results with <span class="math inline">\(x\)</span>.</p></li>
</ol>
<ul>
<li><h3 id="code-14">Code</h3></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())
<span class="co"># remove variables</span>
x&lt;-<span class="fl">1e-50</span>
y1&lt;-<span class="kw">log</span>(<span class="kw">exp</span>(x))
y2&lt;-<span class="kw">exp</span>(<span class="kw">log</span>(x))
c&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(x,y1,y2),<span class="dv">1</span>,<span class="dv">3</span>)
<span class="kw">colnames</span>(c)&lt;-<span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;log(exp(x))&quot;</span>,<span class="st">&quot;exp(log(x))&quot;</span>)
<span class="kw">rownames</span>(c)&lt;-<span class="st">&quot;value&quot;</span>
pander<span class="op">::</span><span class="kw">pandoc.table</span>(c)</code></pre></div>
<table style="width:67%;">
<colgroup>
<col width="16%"></col>
<col width="11%"></col>
<col width="19%"></col>
<col width="19%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">x</th>
<th align="center">log(exp(x))</th>
<th align="center">exp(log(x))</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>value</strong></td>
<td align="center">1e-50</td>
<td align="center">0</td>
<td align="center">1e-50</td>
</tr>
</tbody>
</table>
<p>We can observe <span class="math inline">\(\log \left(\exp \left(10^{-50}\right)\right) \neq \exp \left(\log \left(10^{-50}\right)\right)=10^{-50}\)</span></p>
<p>Now let us see how <span class="math inline">\(all.equal\)</span> will perform.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">isTRUE</span>(<span class="kw">all.equal</span>(x,y1))</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Thus we know <span class="math inline">\(\log \left(\exp \left(10^{-50}\right)\right)=\exp \left(\log \left(10^{-50}\right)\right)=10^{-50}\)</span> hold with near equality.</p>
<ul>
<li><h3 id="wonder-9">Wonder</h3></li>
</ul>
<p>How to avoid the bug of computer calculations?</p>
<p>In view of the comparision of <span class="math inline">\(\log \left(\exp \left(10^{-50}\right)\right)\)</span> and <span class="math inline">\(\exp \left(\log \left(10^{-50}\right)\right)\)</span>, appropriate use of function<span class="math inline">\(log\)</span> might be an effective method to obtain correct computation.</p>
</div>
<div id="question-11.5" class="section level2">
<h2>Question <strong>11.5</strong></h2>
<p>Write a function to solve the equation <span class="math display">\[
\begin{aligned} \frac{2 \Gamma\left(\frac{k}{2}\right)}{\sqrt{\pi(k-1)} \Gamma\left(\frac{k-1}{2}\right)} \int_{0}^{c_{k-1}}\left(1+\frac{u^{2}}{k-1}\right)^{-k / 2} d u \\= \frac{2 \Gamma\left(\frac{k+1}{2}\right)}{\sqrt{\pi k} \Gamma\left(\frac{k}{2}\right)} \int_{0}^{c_{k}}\left(1+\frac{u^{2}}{k}\right)^{-(k+1) / 2} d u \end{aligned}
\]</span> for a, where <span class="math display">\[
c_{k}=\sqrt{\frac{a^{2} k}{k+1-a^{2}}}
\]</span> Compare the solutions with the points <span class="math inline">\(A(k)\)</span> in Exercise 11.4.</p>
</div>
<div id="answer-for-11.5" class="section level2">
<h2>Answer for <strong>11.5</strong></h2>
<ul>
<li><h4 id="basic-idea-15">Basic idea</h4></li>
</ul>
<p>As we know, <span class="math inline">\(X \sim t(n)\)</span> when <span class="math inline">\(X\)</span> have the density function <span class="math display">\[
f(x)=\frac{\Gamma\left(\frac{n+1}{2}\right)}{\sqrt{n \pi} \Gamma\left(\frac{n}{2}\right)}\left(1+\frac{x^{2}}{n}\right)^{-\frac{n+1}{2}}
\]</span> Inspired by 11.4, we want to see the performance of two curves in section [0,sqrt(k)] for k=4 and 9.</p>
<p>Then find the possible section that exists root.</p>
<ul>
<li><h3 id="code-15">Code</h3></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())
K&lt;-<span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">9</span>)
<span class="co">#par(mfrow=c(1,2))</span>
A1&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="kw">sqrt</span>(K[<span class="dv">1</span>]),<span class="fl">0.01</span>)
A2&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="kw">sqrt</span>(K[<span class="dv">2</span>]),<span class="fl">0.01</span>)
g1&lt;-<span class="cf">function</span>(x){(<span class="dv">1</span><span class="op">+</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(k<span class="op">-</span><span class="dv">1</span>))<span class="op">^</span>(<span class="op">-</span>k<span class="op">/</span><span class="dv">2</span>)}
g2&lt;-<span class="cf">function</span>(x){(<span class="dv">1</span><span class="op">+</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>k)<span class="op">^</span>(<span class="op">-</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)}
ck&lt;-<span class="cf">function</span>(k,a){
  <span class="kw">return</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)))
}
y11&lt;-y12&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(A1))
y21&lt;-y22&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(A2))
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(A1)){
  a&lt;-A1[i]
  k&lt;-K[<span class="dv">1</span>]
y11[i]&lt;-<span class="dv">2</span><span class="op">*</span><span class="kw">gamma</span>(k<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>(<span class="kw">sqrt</span>(pi<span class="op">*</span>(k<span class="op">-</span><span class="dv">1</span>))<span class="op">*</span><span class="kw">gamma</span>((k<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>))<span class="op">*</span><span class="kw">integrate</span>(g1, <span class="dt">lower=</span><span class="dv">0</span>, <span class="dt">upper=</span><span class="kw">ck</span>(k<span class="op">-</span><span class="dv">1</span>,a))<span class="op">$</span>value
y12[i]&lt;-<span class="dv">2</span><span class="op">*</span><span class="kw">gamma</span>((k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>(<span class="kw">sqrt</span>(pi<span class="op">*</span>k)<span class="op">*</span><span class="kw">gamma</span>(k<span class="op">/</span><span class="dv">2</span>))<span class="op">*</span><span class="kw">integrate</span>(g2,<span class="dt">lower=</span><span class="dv">0</span>,<span class="dt">upper=</span><span class="kw">ck</span>(k,a))<span class="op">$</span>value
}
<span class="kw">plot</span>(A1,y11,<span class="dt">type=</span><span class="st">'l'</span>,<span class="dt">col=</span><span class="st">'red'</span>)
<span class="kw">lines</span>(A1,y12,<span class="dt">col=</span><span class="st">'blue'</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(A2)){
  a&lt;-A2[i]
  k&lt;-K[<span class="dv">2</span>]
y21[i]&lt;-<span class="dv">2</span><span class="op">*</span><span class="kw">gamma</span>(k<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>(<span class="kw">sqrt</span>(pi<span class="op">*</span>(k<span class="op">-</span><span class="dv">1</span>))<span class="op">*</span><span class="kw">gamma</span>((k<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>))<span class="op">*</span><span class="kw">integrate</span>(g1, <span class="dt">lower=</span><span class="dv">0</span>, <span class="dt">upper=</span><span class="kw">ck</span>(k<span class="op">-</span><span class="dv">1</span>,a))<span class="op">$</span>value
y22[i]&lt;-<span class="dv">2</span><span class="op">*</span><span class="kw">gamma</span>((k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>(<span class="kw">sqrt</span>(pi<span class="op">*</span>k)<span class="op">*</span><span class="kw">gamma</span>(k<span class="op">/</span><span class="dv">2</span>))<span class="op">*</span><span class="kw">integrate</span>(g2,<span class="dt">lower=</span><span class="dv">0</span>,<span class="dt">upper=</span><span class="kw">ck</span>(k,a))<span class="op">$</span>value
}
<span class="kw">plot</span>(A2,y21,<span class="dt">type=</span><span class="st">'l'</span>,<span class="dt">col=</span><span class="st">'red'</span>)
<span class="kw">lines</span>(A2,y22,<span class="dt">col=</span><span class="st">'blue'</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We choose sqrt(k)/2+1 as the upper of our area to extract root.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())
<span class="co"># remove variables</span>
K&lt;-<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>)
<span class="co"># different k</span>
N&lt;-<span class="kw">length</span>(K)
f1 &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
  <span class="dv">2</span><span class="op">*</span><span class="kw">gamma</span>(k<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>(<span class="kw">sqrt</span>(pi<span class="op">*</span>(k<span class="op">-</span><span class="dv">1</span>))<span class="op">*</span><span class="kw">gamma</span>((k<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>))<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(k<span class="op">-</span><span class="dv">1</span>))<span class="op">^</span>(<span class="op">-</span>k<span class="op">/</span><span class="dv">2</span>)
}
<span class="co"># integrand 1</span>
f2&lt;-<span class="cf">function</span>(x) {
  <span class="dv">2</span><span class="op">*</span><span class="kw">gamma</span>((k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>(<span class="kw">sqrt</span>(pi<span class="op">*</span>k)<span class="op">*</span><span class="kw">gamma</span>(k<span class="op">/</span><span class="dv">2</span>))<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>k)<span class="op">^</span>(<span class="op">-</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)
}
<span class="co"># integrand 2</span>
ck&lt;-<span class="cf">function</span>(k,a){
  <span class="kw">return</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)))
}
<span class="co"># integral upper limit</span>
A&lt;-<span class="kw">numeric</span>(N)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){
  k&lt;-K[i]
  ss&lt;-<span class="kw">uniroot</span>(<span class="cf">function</span>(a){
  <span class="kw">integrate</span>(f1, <span class="dt">lower=</span><span class="dv">0</span>, <span class="dt">upper=</span><span class="kw">ck</span>(k<span class="op">-</span><span class="dv">1</span>,a))<span class="op">$</span>value<span class="op">-</span><span class="kw">integrate</span>(f2,<span class="dt">lower=</span><span class="dv">0</span>,<span class="dt">upper=</span><span class="kw">ck</span>(k,a))<span class="op">$</span>value
    },<span class="dt">lower=</span><span class="fl">0.5</span>,<span class="dt">upper=</span><span class="kw">sqrt</span>(k)<span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>)
  A[i]&lt;-ss<span class="op">$</span>root
}</code></pre></div>
<p>So, roots of the equation for k=4:25;100 are stored in vector A.</p>
<p>Compare our solution with 11.4, combining with property of distribution function, we can see A(k) in 11.4 is almost equal to our resluts.</p>
</div>
<div id="question-3" class="section level2">
<h2>Question <strong>3</strong></h2>
<p>A-B-O blood type problem</p>
<p>Let the three alleles be A, B, and O with allele frequencies p,q, and r. The 6 genotype frequencies under HWE and complete counts are as follows. <span class="math display">\[
\begin{array}{|c|c|c|c|c|c|}\hline \text { Genotype } &amp; {A A} &amp; {B B} &amp; {O O} &amp; {A O} &amp; {B O} &amp; {A B} &amp; {S u m} \\ \hline \text { Frequency } &amp; {p^{\sim} 2} &amp; {q^{\sim 2}} &amp; {r^{\sim 2}} &amp; {2 p r} &amp; {2 q r} &amp; {2 p q} &amp; {1} \\ \hline \text { Count } &amp; {n A A} &amp; {n B B} &amp; {n O O} &amp; {n A O} &amp; {n B O} &amp; {n A B} &amp; {n} \\ \hline\end{array}
\]</span> Observed data: <span class="math inline">\(n_{A}=n_{A A}+n_{A O}=28\)</span>(A-type),<span class="math inline">\(n_{B .}=n_{B B}+n_{B O}=24\)</span>(B-type), <span class="math inline">\(n_{O O}=41\)</span> (O-type),<span class="math inline">\(n_{A B}=70\)</span> (AB-type).</p>
<ol style="list-style-type: decimal">
<li><p>Use EM algorithm to solve MLE of p and q (consider missing data <span class="math inline">\(n_{A A}\)</span> and <span class="math inline">\(n_{B B}\)</span> ).</p></li>
<li><p>Show that the log-maximum likelihood values in M-steps are increasing via line plot.</p></li>
</ol>
</div>
<div id="answer-for-3" class="section level2">
<h2>Answer for <strong>3</strong></h2>
<ul>
<li><h3 id="basic-idea-16">Basic idea</h3></li>
</ul>
<p>Observed data likelyhood:</p>
<p><span class="math display">\[
\begin{array}{l}{L\left(p, q | n_{A}, n_{B}, n_{O O}, n_{A B}\right)=\left(p^{2}+2 p r\right)^{n_{A}}\left(q^{2}+2 q r\right)^{n_{B} .}\left(r^{2}\right)^{n_{O O}}(2 p q)^{n_{4 B}}} \end{array}
\]</span></p>
<p>Complete data likelyhood:</p>
<p><span class="math display">\[
\begin{array}{l}{L\left(p, q | n_{A A}, n_{B B}, n_{O O}, n_{A O}, n_{B O}\right)=\left(p^{2}\right)^{n_{4 A}}\left(q^{2}\right)^{n_{B 8}}\left(r^{2}\right)^{n_{O O}}(2 p r)^{n_{B O}}(2 q r)^{n_{S O}}(2 p q)^{n_{A B}}}\end{array}
\]</span></p>
<p>After logarithm:</p>
<p><span class="math display">\[
\begin{aligned} \ln L=&amp; 2 n_{A A} \log (p)+2 n_{B B} \log (q)+2 n_{O O} \log (r)+\left(n_{\cdot A}-n_{A A}\right) \log (2 p r) \\ &amp;+\left(n_{B .}-n_{B B}\right) \log (2 q r)+n_{A B} \log (2 p q) \ \end{aligned}
\]</span></p>
<p><span class="math inline">\(E\)</span>xpectation step:</p>
<p><span class="math display">\[
\begin{aligned} \ E_{\hat{p}_{0}, \hat{q}_{0}}(\ln L)=&amp; \frac{2 \hat{p}_{0}}{\hat{p}_{0}^{2}+2 \hat{p}_{0} \hat{r}_{0}} n_{A} \log (p)+\frac{2 \hat{q}_{0}}{\hat{q}_{0}^{2}+2 \hat{q}_{0} \hat{r}_{0}} n_{B} \log (q)+2 n_{O O} \log (r) \\ &amp;+n_{A} \cdot \frac{2 \hat{p}_{0} \hat{r}_{0}}{\hat{p}_{0}^{2}+2 \hat{p}_{0} \hat{r}_{0}} \log (2 p r)+n_{B} \cdot \frac{2 \hat{q}_{0} \hat{r}_{0}}{\hat{q}_{0}^{2}+2 \hat{q}_{0} \hat{r}_{0}} \log (2 q r)+n_{A B} \log (2 p q) \end{aligned}
\]</span></p>
<p><span class="math inline">\(\hat{r}_{0}=1-\hat{p}_{0}-\hat{q}_{0}\)</span> <span class="math inline">\(r=1-p-q\)</span></p>
<p>Thus we can obtain <span class="math inline">\(\hat{p}_{1}\)</span> and <span class="math inline">\(\hat{q}_{1}\)</span> though MLE</p>
<p>Update the estimates and iteratively repeat the <span class="math inline">\(E\)</span> step and <span class="math inline">\(M\)</span> steps until the algorithm converges to some criterion.</p>
<ul>
<li><h3 id="code-16">Code</h3></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())
<span class="co"># remove variables</span>
<span class="kw">library</span>(rootSolve)
N &lt;-<span class="st"> </span><span class="fl">2e2</span>
<span class="co"># max. number of the iteration</span>
nA&lt;-<span class="dv">28</span>;nB&lt;-<span class="dv">24</span>;nOO&lt;-<span class="dv">41</span>;nAB&lt;-<span class="dv">70</span>
G &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">5</span>,.<span class="dv">4</span>)
<span class="co"># initial estimates </span>
tol &lt;-<span class="st"> </span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.5</span>
G.old &lt;-<span class="st"> </span>G<span class="op">+</span><span class="dv">1</span>
E &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)
<span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){
  E[j]&lt;-<span class="dv">2</span><span class="op">*</span>G[<span class="dv">1</span>]<span class="op">*</span>nA<span class="op">*</span><span class="kw">log</span>(G[<span class="dv">1</span>])<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>G[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>G[<span class="dv">2</span>])<span class="op">+</span><span class="dv">2</span><span class="op">*</span>G[<span class="dv">2</span>]<span class="op">*</span>nB<span class="op">*</span><span class="kw">log</span>(G[<span class="dv">2</span>])<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>G[<span class="dv">2</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>G[<span class="dv">1</span>])<span class="op">+</span><span class="dv">2</span><span class="op">*</span>nOO<span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>G[<span class="dv">1</span>]<span class="op">-</span>G[<span class="dv">2</span>])<span class="op">+</span>nA<span class="op">*</span>(<span class="dv">2</span><span class="op">-</span><span class="dv">2</span><span class="op">*</span>G[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>G[<span class="dv">2</span>])<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>G[<span class="dv">1</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>G[<span class="dv">1</span>]<span class="op">-</span>G[<span class="dv">2</span>]))<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>G[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>G[<span class="dv">2</span>])<span class="op">+</span>nB<span class="op">*</span>(<span class="dv">2</span><span class="op">-</span><span class="dv">2</span><span class="op">*</span>G[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>G[<span class="dv">2</span>])<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>G[<span class="dv">2</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>G[<span class="dv">1</span>]<span class="op">-</span>G[<span class="dv">2</span>]))<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>G[<span class="dv">2</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>G[<span class="dv">1</span>])<span class="op">+</span>nAB<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>G[<span class="dv">1</span>]<span class="op">*</span>G[<span class="dv">2</span>])
  model&lt;-<span class="cf">function</span>(x){
    F1&lt;-<span class="dv">2</span><span class="op">*</span>G[<span class="dv">1</span>]<span class="op">*</span>nA<span class="op">/</span>((<span class="dv">2</span><span class="op">-</span>G[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>G[<span class="dv">2</span>])<span class="op">*</span>x[<span class="dv">1</span>])<span class="op">-</span><span class="dv">2</span><span class="op">*</span>nOO<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>])<span class="op">+</span>nA<span class="op">*</span>(<span class="dv">2</span><span class="op">-</span><span class="dv">2</span><span class="op">*</span>G[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>G[<span class="dv">2</span>])<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="dv">2</span><span class="op">*</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>])<span class="op">/</span>((<span class="dv">2</span><span class="op">-</span>G[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>G[<span class="dv">2</span>])<span class="op">*</span>x[<span class="dv">1</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>]))<span class="op">-</span>nB<span class="op">*</span>(<span class="dv">2</span><span class="op">-</span><span class="dv">2</span><span class="op">*</span>G[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>G[<span class="dv">2</span>])<span class="op">/</span>((<span class="dv">2</span><span class="op">-</span>G[<span class="dv">2</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>G[<span class="dv">1</span>])<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>]))<span class="op">+</span>nAB<span class="op">/</span>x[<span class="dv">1</span>]
    F2&lt;-<span class="dv">2</span><span class="op">*</span>G[<span class="dv">2</span>]<span class="op">*</span>nB<span class="op">/</span>((<span class="dv">2</span><span class="op">-</span>G[<span class="dv">2</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>G[<span class="dv">1</span>])<span class="op">*</span>x[<span class="dv">2</span>])<span class="op">-</span><span class="dv">2</span><span class="op">*</span>nOO<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>])<span class="op">-</span>nA<span class="op">*</span>(<span class="dv">2</span><span class="op">-</span><span class="dv">2</span><span class="op">*</span>G[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>G[<span class="dv">2</span>])<span class="op">/</span>((<span class="dv">2</span><span class="op">-</span>G[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>G[<span class="dv">2</span>])<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>]))<span class="op">+</span>nB<span class="op">*</span>(<span class="dv">2</span><span class="op">-</span><span class="dv">2</span><span class="op">*</span>G[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>G[<span class="dv">2</span>])<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="dv">2</span><span class="op">*</span>x[<span class="dv">2</span>]<span class="op">-</span>x[<span class="dv">1</span>])<span class="op">/</span>((<span class="dv">2</span><span class="op">-</span>G[<span class="dv">2</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>G[<span class="dv">1</span>])<span class="op">*</span>x[<span class="dv">2</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>]))<span class="op">+</span>nAB<span class="op">/</span>x[<span class="dv">2</span>]
    <span class="kw">c</span>(<span class="dt">F1=</span>F1,<span class="dt">F2=</span>F2)
  }
  ss&lt;-<span class="kw">multiroot</span>(<span class="dt">f=</span>model,<span class="dt">star=</span><span class="kw">c</span>(.<span class="dv">1</span>,.<span class="dv">1</span>))
  G&lt;-ss<span class="op">$</span>root
  <span class="co"># update p and q</span>
  <span class="cf">if</span> (<span class="kw">sum</span>(<span class="kw">abs</span>(G<span class="op">-</span>G.old)<span class="op">/</span>G.old)<span class="op">&lt;</span>tol) <span class="cf">break</span>
  G.old&lt;-G
}
<span class="kw">print</span>(G.old)</code></pre></div>
<p>[1] 0.3273442 0.3104267</p>
<p>Therefore we obtained MLE of p and q, say 0.327 and 0.31 respectively.</p>
<p>Now let us show the log-maximum likelihood values in M-steps via line plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(E[<span class="dv">1</span><span class="op">:</span><span class="dv">11</span>],<span class="dt">type=</span><span class="st">'l'</span>,<span class="dt">xlab=</span><span class="st">&quot;iteration time&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;likelihood value&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As shown above, we can observe that the log-maximum likelihood values are increasing in M-steps.</p>
</div>
<div id="question-11.1.2-exercise-3" class="section level2">
<h2>Question <strong>11.1.2 Exercise 3</strong></h2>
<p>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list:</p>
<p>formulas &lt;- list(</p>
<p>mpg ~ disp,</p>
<p>mpg ~ I(1 / disp),</p>
<p>mpg ~ disp + wt,</p>
<p>mpg ~ I(1 / disp) + wt</p>
<p>)</p>
</div>
<div id="answer-for-11.1.2-exercise-3" class="section level2">
<h2>Answer for <strong>11.1.2 Exercise 3</strong></h2>
<ul>
<li><h3 id="processes-and-code">Processes and Code</h3></li>
</ul>
<p>First, we use <span class="math inline">\(for\)</span> loops to fit linear models as we learned before and store the results in <span class="math inline">\(fit1\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())
<span class="co"># remove variables</span>
<span class="kw">attach</span>(mtcars)
formulas &lt;-<span class="st"> </span><span class="kw">list</span>(
mpg <span class="op">~</span><span class="st"> </span>disp,
mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),
mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,
mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt
)
fit11&lt;-<span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>,<span class="kw">length</span>(formulas))
cof11&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">3</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(formulas)){
  fit11[[i]]&lt;-<span class="kw">lm</span>(formulas[[i]])
  cof11[i,<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(fit11[[i]]<span class="op">$</span>coefficients)]&lt;-fit11[[i]]<span class="op">$</span>coefficients
}
<span class="kw">colnames</span>(cof11)&lt;-<span class="kw">c</span>(<span class="st">&quot;intercept&quot;</span>,<span class="st">&quot;coefficient1&quot;</span>,<span class="st">&quot;coefficient2&quot;</span>)
<span class="kw">rownames</span>(cof11)&lt;-<span class="kw">c</span>(<span class="st">&quot;mpg ~ disp&quot;</span>,<span class="st">&quot;mpg ~ I(1 / disp)&quot;</span>,<span class="st">&quot;mpg ~ disp + wt&quot;</span>,<span class="st">&quot;mpg ~ I(1 / disp) + wt&quot;</span>)
pander<span class="op">::</span><span class="kw">pandoc.table</span>(cof11)</code></pre></div>
<table style="width:99%;">
<colgroup>
<col width="40%"></col>
<col width="16%"></col>
<col width="20%"></col>
<col width="20%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">intercept</th>
<th align="center">coefficient1</th>
<th align="center">coefficient2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>mpg ~ disp</strong></td>
<td align="center">29.6</td>
<td align="center">-0.04122</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><strong>mpg ~ I(1 / disp)</strong></td>
<td align="center">10.75</td>
<td align="center">1558</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center"><strong>mpg ~ disp + wt</strong></td>
<td align="center">34.96</td>
<td align="center">-0.01772</td>
<td align="center">-3.351</td>
</tr>
<tr class="even">
<td align="center"><strong>mpg ~ I(1 / disp) + wt</strong></td>
<td align="center">19.02</td>
<td align="center">1143</td>
<td align="center">-1.798</td>
</tr>
</tbody>
</table>
<p>Now we use <span class="math inline">\(lapply\)</span> to realize it.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit12&lt;-<span class="kw">lapply</span>(formulas,lm)
cof12&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">3</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(formulas)){
  cof12[i,<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(fit12[[i]]<span class="op">$</span>coefficients)]&lt;-fit12[[i]]<span class="op">$</span>coefficients
}
<span class="kw">colnames</span>(cof12)&lt;-<span class="kw">c</span>(<span class="st">&quot;intercept&quot;</span>,<span class="st">&quot;coefficient1&quot;</span>,<span class="st">&quot;coefficient2&quot;</span>)
<span class="kw">rownames</span>(cof12)&lt;-<span class="kw">c</span>(<span class="st">&quot;mpg ~ disp&quot;</span>,<span class="st">&quot;mpg ~ I(1 / disp)&quot;</span>,<span class="st">&quot;mpg ~ disp + wt&quot;</span>,<span class="st">&quot;mpg ~ I(1 / disp) + wt&quot;</span>)
pander<span class="op">::</span><span class="kw">pandoc.table</span>(cof12)</code></pre></div>
<table style="width:99%;">
<colgroup>
<col width="40%"></col>
<col width="16%"></col>
<col width="20%"></col>
<col width="20%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">intercept</th>
<th align="center">coefficient1</th>
<th align="center">coefficient2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>mpg ~ disp</strong></td>
<td align="center">29.6</td>
<td align="center">-0.04122</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><strong>mpg ~ I(1 / disp)</strong></td>
<td align="center">10.75</td>
<td align="center">1558</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center"><strong>mpg ~ disp + wt</strong></td>
<td align="center">34.96</td>
<td align="center">-0.01772</td>
<td align="center">-3.351</td>
</tr>
<tr class="even">
<td align="center"><strong>mpg ~ I(1 / disp) + wt</strong></td>
<td align="center">19.02</td>
<td align="center">1143</td>
<td align="center">-1.798</td>
</tr>
</tbody>
</table>
</div>
<div id="question-11.1.2-exercise-4" class="section level2">
<h2>Question <strong>11.1.2 Exercise 4</strong></h2>
<p>Fit the model mpg ~ disp to each of the bootstrap replicates of mtcars in the list below by using a for loop and lapply(). Can you do it without an anonymous function?</p>
<p>bootstraps &lt;- lapply(1:10, function(i) {</p>
<p>rows &lt;- sample(1:nrow(mtcars), rep = TRUE)</p>
<p>mtcars[rows, ]</p>
<p>})</p>
</div>
<div id="answer-for-11.1.2-exercise-4" class="section level2">
<h2>Answer for <strong>11.1.2 Exercise 4</strong></h2>
<ul>
<li><h3 id="processes-and-code-1">Processes and Code</h3></li>
</ul>
<p>First, we use <span class="math inline">\(for\)</span> loops to fit the model mpg ~ disp to each of the bootstrap replicates and show the coefficients.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {
rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)
mtcars[rows, ]
})
fit21&lt;-<span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>,<span class="kw">length</span>(bootstraps))
cof21&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">2</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(bootstraps)){
  fit21[[i]]&lt;-<span class="kw">lm</span>(bootstraps[[i]]<span class="op">$</span>mpg<span class="op">~</span>bootstraps[[i]]<span class="op">$</span>disp)
  cof21[i,]&lt;-fit21[[i]]<span class="op">$</span>coefficients
}
<span class="kw">colnames</span>(cof21)&lt;-<span class="kw">c</span>(<span class="st">&quot;intercept&quot;</span>,<span class="st">&quot;coefficient&quot;</span>)
<span class="kw">rownames</span>(cof21)&lt;-<span class="kw">c</span>(<span class="st">&quot;rep1&quot;</span>,<span class="st">&quot;rep2&quot;</span>,<span class="st">&quot;rep3&quot;</span>,<span class="st">&quot;rep4&quot;</span>,<span class="st">&quot;rep5&quot;</span>,<span class="st">&quot;rep6&quot;</span>,<span class="st">&quot;rep7&quot;</span>,<span class="st">&quot;rep8&quot;</span>,<span class="st">&quot;rep9&quot;</span>,<span class="st">&quot;rep10&quot;</span>)
pander<span class="op">::</span><span class="kw">pandoc.table</span>(cof21)</code></pre></div>
<table style="width:51%;">
<colgroup>
<col width="16%"></col>
<col width="16%"></col>
<col width="18%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">intercept</th>
<th align="center">coefficient</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>rep1</strong></td>
<td align="center">26.72</td>
<td align="center">-0.03241</td>
</tr>
<tr class="even">
<td align="center"><strong>rep2</strong></td>
<td align="center">29.79</td>
<td align="center">-0.04157</td>
</tr>
<tr class="odd">
<td align="center"><strong>rep3</strong></td>
<td align="center">29.39</td>
<td align="center">-0.03905</td>
</tr>
<tr class="even">
<td align="center"><strong>rep4</strong></td>
<td align="center">27.81</td>
<td align="center">-0.03279</td>
</tr>
<tr class="odd">
<td align="center"><strong>rep5</strong></td>
<td align="center">31.14</td>
<td align="center">-0.04697</td>
</tr>
<tr class="even">
<td align="center"><strong>rep6</strong></td>
<td align="center">30.05</td>
<td align="center">-0.04754</td>
</tr>
<tr class="odd">
<td align="center"><strong>rep7</strong></td>
<td align="center">31.19</td>
<td align="center">-0.04648</td>
</tr>
<tr class="even">
<td align="center"><strong>rep8</strong></td>
<td align="center">28.23</td>
<td align="center">-0.03622</td>
</tr>
<tr class="odd">
<td align="center"><strong>rep9</strong></td>
<td align="center">26.74</td>
<td align="center">-0.03122</td>
</tr>
<tr class="even">
<td align="center"><strong>rep10</strong></td>
<td align="center">30.37</td>
<td align="center">-0.04073</td>
</tr>
</tbody>
</table>
<p>Then we use <span class="math inline">\(lapply\)</span> to fit the models.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit22&lt;-<span class="kw">lapply</span>(bootstraps,<span class="cf">function</span>(x){
  <span class="kw">lm</span>(x<span class="op">$</span>mpg<span class="op">~</span>x<span class="op">$</span>disp)
})
cof22&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">2</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(bootstraps)){
  cof22[i,]&lt;-fit22[[i]]<span class="op">$</span>coefficients
}
<span class="kw">colnames</span>(cof22)&lt;-<span class="kw">c</span>(<span class="st">&quot;intercept&quot;</span>,<span class="st">&quot;coefficient&quot;</span>)
<span class="kw">rownames</span>(cof22)&lt;-<span class="kw">c</span>(<span class="st">&quot;rep1&quot;</span>,<span class="st">&quot;rep2&quot;</span>,<span class="st">&quot;rep3&quot;</span>,<span class="st">&quot;rep4&quot;</span>,<span class="st">&quot;rep5&quot;</span>,<span class="st">&quot;rep6&quot;</span>,<span class="st">&quot;rep7&quot;</span>,<span class="st">&quot;rep8&quot;</span>,<span class="st">&quot;rep9&quot;</span>,<span class="st">&quot;rep10&quot;</span>)
pander<span class="op">::</span><span class="kw">pandoc.table</span>(cof22)</code></pre></div>
<table style="width:51%;">
<colgroup>
<col width="16%"></col>
<col width="16%"></col>
<col width="18%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">intercept</th>
<th align="center">coefficient</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>rep1</strong></td>
<td align="center">26.72</td>
<td align="center">-0.03241</td>
</tr>
<tr class="even">
<td align="center"><strong>rep2</strong></td>
<td align="center">29.79</td>
<td align="center">-0.04157</td>
</tr>
<tr class="odd">
<td align="center"><strong>rep3</strong></td>
<td align="center">29.39</td>
<td align="center">-0.03905</td>
</tr>
<tr class="even">
<td align="center"><strong>rep4</strong></td>
<td align="center">27.81</td>
<td align="center">-0.03279</td>
</tr>
<tr class="odd">
<td align="center"><strong>rep5</strong></td>
<td align="center">31.14</td>
<td align="center">-0.04697</td>
</tr>
<tr class="even">
<td align="center"><strong>rep6</strong></td>
<td align="center">30.05</td>
<td align="center">-0.04754</td>
</tr>
<tr class="odd">
<td align="center"><strong>rep7</strong></td>
<td align="center">31.19</td>
<td align="center">-0.04648</td>
</tr>
<tr class="even">
<td align="center"><strong>rep8</strong></td>
<td align="center">28.23</td>
<td align="center">-0.03622</td>
</tr>
<tr class="odd">
<td align="center"><strong>rep9</strong></td>
<td align="center">26.74</td>
<td align="center">-0.03122</td>
</tr>
<tr class="even">
<td align="center"><strong>rep10</strong></td>
<td align="center">30.37</td>
<td align="center">-0.04073</td>
</tr>
</tbody>
</table>
<p>Finally, we try to do it without an anonymous function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit23&lt;-<span class="kw">lapply</span>(bootstraps,lm,<span class="dt">formula=</span>mpg<span class="op">~</span>disp)
cof23&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">2</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(bootstraps)){
  cof23[i,]&lt;-fit23[[i]]<span class="op">$</span>coefficients
}
<span class="kw">colnames</span>(cof23)&lt;-<span class="kw">c</span>(<span class="st">&quot;intercept&quot;</span>,<span class="st">&quot;coefficient&quot;</span>)
<span class="kw">rownames</span>(cof23)&lt;-<span class="kw">c</span>(<span class="st">&quot;rep1&quot;</span>,<span class="st">&quot;rep2&quot;</span>,<span class="st">&quot;rep3&quot;</span>,<span class="st">&quot;rep4&quot;</span>,<span class="st">&quot;rep5&quot;</span>,<span class="st">&quot;rep6&quot;</span>,<span class="st">&quot;rep7&quot;</span>,<span class="st">&quot;rep8&quot;</span>,<span class="st">&quot;rep9&quot;</span>,<span class="st">&quot;rep10&quot;</span>)
pander<span class="op">::</span><span class="kw">pandoc.table</span>(cof23)</code></pre></div>
<table style="width:51%;">
<colgroup>
<col width="16%"></col>
<col width="16%"></col>
<col width="18%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">intercept</th>
<th align="center">coefficient</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>rep1</strong></td>
<td align="center">26.72</td>
<td align="center">-0.03241</td>
</tr>
<tr class="even">
<td align="center"><strong>rep2</strong></td>
<td align="center">29.79</td>
<td align="center">-0.04157</td>
</tr>
<tr class="odd">
<td align="center"><strong>rep3</strong></td>
<td align="center">29.39</td>
<td align="center">-0.03905</td>
</tr>
<tr class="even">
<td align="center"><strong>rep4</strong></td>
<td align="center">27.81</td>
<td align="center">-0.03279</td>
</tr>
<tr class="odd">
<td align="center"><strong>rep5</strong></td>
<td align="center">31.14</td>
<td align="center">-0.04697</td>
</tr>
<tr class="even">
<td align="center"><strong>rep6</strong></td>
<td align="center">30.05</td>
<td align="center">-0.04754</td>
</tr>
<tr class="odd">
<td align="center"><strong>rep7</strong></td>
<td align="center">31.19</td>
<td align="center">-0.04648</td>
</tr>
<tr class="even">
<td align="center"><strong>rep8</strong></td>
<td align="center">28.23</td>
<td align="center">-0.03622</td>
</tr>
<tr class="odd">
<td align="center"><strong>rep9</strong></td>
<td align="center">26.74</td>
<td align="center">-0.03122</td>
</tr>
<tr class="even">
<td align="center"><strong>rep10</strong></td>
<td align="center">30.37</td>
<td align="center">-0.04073</td>
</tr>
</tbody>
</table>
</div>
<div id="question-11.1.2-exercise-5" class="section level2">
<h2>Question <strong>11.1.2 Exercise 5</strong></h2>
<p>For each model in the previous two exercises, extract R2 using the function below.</p>
<p>rsq &lt;- function(mod) summary(mod)$r.squared</p>
</div>
<div id="answer-for-11.1.2-exercise-5" class="section level2">
<h2>Answer for <strong>11.1.2 Exercise 5</strong></h2>
<ul>
<li><h3 id="processes-and-code-2">Processes and Code</h3></li>
</ul>
<p>For Exercise 3, we extract R2 for <span class="math inline">\(lapply\)</span> model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rsq &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.square
rsq1 &lt;-<span class="st"> </span><span class="kw">lapply</span>(fit12,rsq)
r_squared1&lt;-<span class="kw">matrix</span>(rsq1,<span class="dv">4</span>,<span class="dv">1</span>)
<span class="kw">colnames</span>(r_squared1)&lt;-<span class="st">&quot;R_squared&quot;</span>
<span class="kw">rownames</span>(r_squared1)&lt;-<span class="kw">c</span>(<span class="st">&quot;mpg ~ disp&quot;</span>,<span class="st">&quot;mpg ~ I(1 / disp)&quot;</span>,<span class="st">&quot;mpg ~ disp + wt&quot;</span>,<span class="st">&quot;mpg ~ I(1 / disp) + wt&quot;</span>)
pander<span class="op">::</span><span class="kw">pandoc.table</span>(r_squared1)</code></pre></div>
<table style="width:56%;">
<colgroup>
<col width="40%"></col>
<col width="15%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">R_squared</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>mpg ~ disp</strong></td>
<td align="center">0.7183433</td>
</tr>
<tr class="even">
<td align="center"><strong>mpg ~ I(1 / disp)</strong></td>
<td align="center">0.8596865</td>
</tr>
<tr class="odd">
<td align="center"><strong>mpg ~ disp + wt</strong></td>
<td align="center">0.7809306</td>
</tr>
<tr class="even">
<td align="center"><strong>mpg ~ I(1 / disp) + wt</strong></td>
<td align="center">0.8838038</td>
</tr>
</tbody>
</table>
<p>For Exercise 4, we extract R2 for <span class="math inline">\(lapply\)</span> model without an anonymous function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rsq2 &lt;-<span class="st"> </span><span class="kw">lapply</span>(fit23,rsq)
r_squared2&lt;-<span class="kw">matrix</span>(rsq2,<span class="dv">10</span>,<span class="dv">1</span>)
<span class="kw">colnames</span>(r_squared2)&lt;-<span class="st">&quot;R_squared&quot;</span>
<span class="kw">rownames</span>(r_squared2)&lt;-<span class="kw">c</span>(<span class="st">&quot;rep1&quot;</span>,<span class="st">&quot;rep2&quot;</span>,<span class="st">&quot;rep3&quot;</span>,<span class="st">&quot;rep4&quot;</span>,<span class="st">&quot;rep5&quot;</span>,<span class="st">&quot;rep6&quot;</span>,<span class="st">&quot;rep7&quot;</span>,<span class="st">&quot;rep8&quot;</span>,<span class="st">&quot;rep9&quot;</span>,<span class="st">&quot;rep10&quot;</span>)
pander<span class="op">::</span><span class="kw">pandoc.table</span>(r_squared2)</code></pre></div>
<table style="width:33%;">
<colgroup>
<col width="16%"></col>
<col width="16%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">R_squared</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>rep1</strong></td>
<td align="center">0.8034013</td>
</tr>
<tr class="even">
<td align="center"><strong>rep2</strong></td>
<td align="center">0.7386716</td>
</tr>
<tr class="odd">
<td align="center"><strong>rep3</strong></td>
<td align="center">0.6572146</td>
</tr>
<tr class="even">
<td align="center"><strong>rep4</strong></td>
<td align="center">0.6786082</td>
</tr>
<tr class="odd">
<td align="center"><strong>rep5</strong></td>
<td align="center">0.7559773</td>
</tr>
<tr class="even">
<td align="center"><strong>rep6</strong></td>
<td align="center">0.7712581</td>
</tr>
<tr class="odd">
<td align="center"><strong>rep7</strong></td>
<td align="center">0.6752694</td>
</tr>
<tr class="even">
<td align="center"><strong>rep8</strong></td>
<td align="center">0.6337313</td>
</tr>
<tr class="odd">
<td align="center"><strong>rep9</strong></td>
<td align="center">0.6508021</td>
</tr>
<tr class="even">
<td align="center"><strong>rep10</strong></td>
<td align="center">0.7325716</td>
</tr>
</tbody>
</table>
</div>
<div id="question-11.2.5-exercise-3" class="section level2">
<h2>Question <strong>11.2.5 Exercise 3</strong></h2>
<p>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial.</p>
<p>trials &lt;- replicate(</p>
<p>100,</p>
<p>t.test(rpois(10, 10), rpois(7, 10)),</p>
<p>simplify = FALSE</p>
<p>)</p>
<p>Extra challenge: get rid of the anonymous function by using [[ directly.</p>
</div>
<div id="answer-for-11.2.5-exercise-3" class="section level2">
<h2>Answer for <strong>11.2.5 Exercise 3</strong></h2>
<p>We extract the p-value from every trial and take the first 5 for example.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())
<span class="co"># remove variables</span>
trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(
<span class="dv">100</span>,
<span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),
<span class="dt">simplify =</span> <span class="ot">FALSE</span>
)
p_value&lt;-<span class="kw">sapply</span>(trials,<span class="cf">function</span>(x) <span class="kw">return</span>(x<span class="op">$</span>p.value))
p&lt;-<span class="kw">matrix</span>(p_value[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>],<span class="dv">5</span>,<span class="dv">1</span>)
<span class="kw">colnames</span>(p)&lt;-<span class="st">&quot;p_value&quot;</span>
<span class="kw">rownames</span>(p)&lt;-<span class="kw">c</span>(<span class="st">&quot;trial1&quot;</span>,<span class="st">&quot;trial2&quot;</span>,<span class="st">&quot;trial3&quot;</span>,<span class="st">&quot;trial4&quot;</span>,<span class="st">&quot;trial5&quot;</span>)
pander<span class="op">::</span><span class="kw">pandoc.table</span>(p)</code></pre></div>
<table style="width:31%;">
<colgroup>
<col width="18%"></col>
<col width="12%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">p_value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>trial1</strong></td>
<td align="center">0.7732</td>
</tr>
<tr class="even">
<td align="center"><strong>trial2</strong></td>
<td align="center">0.424</td>
</tr>
<tr class="odd">
<td align="center"><strong>trial3</strong></td>
<td align="center">0.1576</td>
</tr>
<tr class="even">
<td align="center"><strong>trial4</strong></td>
<td align="center">0.7405</td>
</tr>
<tr class="odd">
<td align="center"><strong>trial5</strong></td>
<td align="center">0.5048</td>
</tr>
</tbody>
</table>
<p>Also, we shall use <span class="math inline">\(sapply()\)</span> without an anonymous function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p_value2&lt;-<span class="kw">sapply</span>(trials,<span class="st">'[['</span>,<span class="dv">3</span>)
p2&lt;-<span class="kw">matrix</span>(p_value2[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>],<span class="dv">5</span>,<span class="dv">1</span>)
<span class="kw">colnames</span>(p2)&lt;-<span class="st">&quot;p_value&quot;</span>
<span class="kw">rownames</span>(p2)&lt;-<span class="kw">c</span>(<span class="st">&quot;trial1&quot;</span>,<span class="st">&quot;trial2&quot;</span>,<span class="st">&quot;trial3&quot;</span>,<span class="st">&quot;trial4&quot;</span>,<span class="st">&quot;trial5&quot;</span>)
pander<span class="op">::</span><span class="kw">pandoc.table</span>(p2)</code></pre></div>
<table style="width:31%;">
<colgroup>
<col width="18%"></col>
<col width="12%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">p_value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>trial1</strong></td>
<td align="center">0.7732</td>
</tr>
<tr class="even">
<td align="center"><strong>trial2</strong></td>
<td align="center">0.424</td>
</tr>
<tr class="odd">
<td align="center"><strong>trial3</strong></td>
<td align="center">0.1576</td>
</tr>
<tr class="even">
<td align="center"><strong>trial4</strong></td>
<td align="center">0.7405</td>
</tr>
<tr class="odd">
<td align="center"><strong>trial5</strong></td>
<td align="center">0.5048</td>
</tr>
</tbody>
</table>
</div>
<div id="question-11.2.5-exercise-7" class="section level2">
<h2>Question <strong>11.2.5 Exercise 7</strong></h2>
<p>Implement mcsapply() , a multicore version of sapply() . Can you implement mcvapply() , a parallel version of vapply() ? Why or why not?</p>
</div>
<div id="answer-for-11.2.5-exercise-7" class="section level2">
<h2>Answer for <strong>11.2.5 Exercise 7</strong></h2>
<p>First, we implement a multicore version of sapply(), named as mcsapply().</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())
<span class="co"># remove variables</span>
<span class="kw">library</span>(parallel)
<span class="kw">attach</span>(mtcars)</code></pre></div>
<pre><code>## The following objects are masked from mtcars (pos = 4):
## 
##     am, carb, cyl, disp, drat, gear, hp, mpg, qsec, vs, wt</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cores &lt;-<span class="st"> </span><span class="kw">detectCores</span>()
cluster &lt;-<span class="st"> </span><span class="kw">makePSOCKcluster</span>(cores)
<span class="co">#  set up a local cluster</span>
mcsapply &lt;-<span class="st"> </span><span class="cf">function</span>(x, f, ...) {
res &lt;-<span class="st"> </span><span class="kw">parLapply</span>(cluster, x, f)
<span class="kw">simplify2array</span>(res)
} </code></pre></div>
<p>To show the advantages of <span class="math inline">\(mcsapply\)</span>, we take a realistic example.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">boot_df &lt;-<span class="st"> </span><span class="cf">function</span>(x) x[<span class="kw">sample</span>(<span class="kw">nrow</span>(x), <span class="dt">rep =</span> T), ]
boot_lm &lt;-<span class="st"> </span><span class="cf">function</span>(i) {
  <span class="kw">return</span>(<span class="kw">summary</span>(<span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>wt <span class="op">+</span><span class="st"> </span>disp, <span class="dt">data =</span> mtcars[<span class="kw">sample</span>(<span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> T), ]))<span class="op">$</span>r.square)
}
T1&lt;-<span class="kw">system.time</span>(<span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">500</span>, boot_lm))
T2&lt;-<span class="kw">system.time</span>(<span class="kw">mcsapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">500</span>, boot_lm))
c&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(T1[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>],T2[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]),<span class="dv">2</span>,<span class="dv">3</span>)
<span class="kw">colnames</span>(c)&lt;-<span class="kw">c</span>(<span class="st">&quot;user&quot;</span>,<span class="st">&quot;system&quot;</span>,<span class="st">&quot;elapsed&quot;</span>)
<span class="kw">rownames</span>(c)&lt;-<span class="kw">c</span>(<span class="st">&quot;sapply&quot;</span>,<span class="st">&quot;mcsapply&quot;</span>)
pander<span class="op">::</span><span class="kw">pandoc.table</span>(c)</code></pre></div>
<table style="width:56%;">
<colgroup>
<col width="20%"></col>
<col width="9%"></col>
<col width="12%"></col>
<col width="12%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">user</th>
<th align="center">system</th>
<th align="center">elapsed</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>sapply</strong></td>
<td align="center">1.01</td>
<td align="center">1.07</td>
<td align="center">0.01</td>
</tr>
<tr class="even">
<td align="center"><strong>mcsapply</strong></td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0.31</td>
</tr>
</tbody>
</table>
<p>Then come the parallel version of vapply(). We do not think it is implementable in view of <span class="math inline">\(vapply()\)</span> shall check the length and type of results in appling function to each element in a list.</p>
</div>
<div id="question-ar2" class="section level2">
<h2>Question <strong>AR2</strong></h2>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
</div>
<div id="answer-for-ar2" class="section level2">
<h2>Answer for <strong>AR2</strong></h2>
<ul>
<li><h3 id="basic-idea-17">Basic idea</h3></li>
</ul>
<p>Markov Chain Monte Carlo methods estimate the integral by Monte Carlo integration, and the Markov Chain provides the sampler that generates the random observations from the target distribution, saying the standard Laplace distribution here.</p>
<p>The standard Laplace distribution has density <span class="math display">\[
f(x)=\frac{1}{2} e^{-|x|}, x \in \mathbb{R}
\]</span></p>
<p>We choose a symmetric proposal distribution as <span class="math inline">\(N\left(X_{t}, \sigma^{2}\right)\)</span>, in that the generated chain from it is able to converge to the standard Laplace distribution and enjoy irreducibility, positive recurrence, and aperiodicity.</p>
<ul>
<li><h3 id="flowchart-9">Flowchart</h3></li>
</ul>
<ol style="list-style-type: decimal">
<li><p>Generate <span class="math inline">\(Y\)</span> from <span class="math inline">\(N\left(X_{t}, \sigma^{2}\right)\)</span>.</p></li>
<li><p>Given initial value <span class="math inline">\(X_{0}\)</span>.</p></li>
<li><p>Generate <span class="math inline">\(U\)</span> from Uniform(0,1).</p></li>
<li><p>If <span class="math display">\[
U \leq \frac{f(Y)}{f\left(X_{t}\right)}
\]</span></p></li>
</ol>
<p>accept <span class="math inline">\(Y\)</span> and set <span class="math inline">\(X_{t+1}=Y\)</span> ; otherwise set <span class="math inline">\(X_{t+1}=X_{t}\)</span>.</p>
<ol start="5" style="list-style-type: decimal">
<li><p>Increment <span class="math inline">\(t\)</span> until the chain has converged to a stationary distribution.</p></li>
<li><p>Repeating the simulation with different choices of <span class="math inline">\(\sigma\)</span></p></li>
</ol>
<ul>
<li><h3 id="code-17">Code</h3></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())
<span class="co"># remove variables</span>
<span class="kw">library</span>(GeneralizedHyperbolic)
<span class="co"># to obtain function</span>
<span class="kw">library</span>(Rcpp)
<span class="co"># Attach R package &quot;Rcpp&quot;</span>
<span class="co">#dir_cpp&lt;-'Rcpp/'</span>
<span class="co"># Can create source file in Rstudio</span>
<span class="co">#sourceCpp(paste0(dir_cpp,&quot;MetropolisC.cpp&quot;))</span>
<span class="kw">library</span>(microbenchmark)
<span class="kw">set.seed</span>(<span class="dv">123</span>)
N &lt;-<span class="st"> </span><span class="dv">2000</span>
<span class="co"># iteration time</span>
sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, .<span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">16</span>)
<span class="co"># different choices of sigma</span>
x0&lt;-<span class="dv">25</span>
<span class="co"># initial setting</span>
myrw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(a, x0, N) {
  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)
  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0
  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)
  k &lt;-<span class="st"> </span><span class="dv">0</span>
  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {
    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="op">-</span><span class="dv">1</span>], a)
    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">dskewlap</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">dskewlap</span>(x[i<span class="op">-</span><span class="dv">1</span>])))
      x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {
        x[i] &lt;-<span class="st"> </span>x[i<span class="op">-</span><span class="dv">1</span>]
        k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
      }
  }
  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))
}
<span class="co"># function to generate the chain</span>
r1 &lt;-<span class="st"> </span><span class="kw">myrw.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N)
r2 &lt;-<span class="st"> </span><span class="kw">myrw.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N)
r3 &lt;-<span class="st"> </span><span class="kw">myrw.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)
r4 &lt;-<span class="st"> </span><span class="kw">myrw.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N)
<span class="co"># results by R</span>
<span class="co">#r11 &lt;-MetropolisC(sigma[1], x0, N)</span>
<span class="co">#r21 &lt;- MetropolisC(sigma[2], x0, N)</span>
<span class="co">#r31 &lt;- MetropolisC(sigma[3], x0, N)</span>
<span class="co">#r41 &lt;- MetropolisC(sigma[4], x0, N)</span>
<span class="co"># results by Rcpp</span>
c&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(r1<span class="op">$</span>k<span class="op">/</span>N, r2<span class="op">$</span>k<span class="op">/</span>N, r3<span class="op">$</span>k<span class="op">/</span>N, r4<span class="op">$</span>k<span class="op">/</span>N),<span class="dv">1</span>,<span class="dv">4</span>)
<span class="kw">colnames</span>(c)&lt;-<span class="kw">c</span>(<span class="st">&quot;sigma=0.05&quot;</span>,<span class="st">&quot;sigma=0.5&quot;</span>,<span class="st">&quot;sigma=2&quot;</span>,<span class="st">&quot;sigma=16&quot;</span>)
<span class="kw">rownames</span>(c)&lt;-<span class="st">&quot;rejection rate(R)&quot;</span>
pander<span class="op">::</span><span class="kw">pandoc.table</span>(c)</code></pre></div>
<table style="width:96%;">
<colgroup>
<col width="33%"></col>
<col width="18%"></col>
<col width="16%"></col>
<col width="13%"></col>
<col width="13%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">sigma=0.05</th>
<th align="center">sigma=0.5</th>
<th align="center">sigma=2</th>
<th align="center">sigma=16</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>rejection rate(R)</strong></td>
<td align="center">0.016</td>
<td align="center">0.1685</td>
<td align="center">0.472</td>
<td align="center">0.905</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#b&lt;-matrix(c(r11[N+1]/N, r21[N+1]/N, r31[N+1]/N, r41[N+1]/N),1,4)</span>
<span class="co">#colnames(b)&lt;-c(&quot;sigma=0.05&quot;,&quot;sigma=0.5&quot;,&quot;sigma=2&quot;,&quot;sigma=16&quot;)</span>
<span class="co">#rownames(b)&lt;-&quot;rejection rate(Rcpp)&quot;</span>
<span class="co">#pander::pandoc.table(b)</span></code></pre></div>
<p>As we can observe in the table, both the second and third chain have a rejection rate in the range [0.15, 0.5].</p>
<p>Then we will show what can happen to the random walk Metropolis sampler when the variance of proposal distribution change.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#par(mfrow=c(2,2))</span>
<span class="co">#plot(r11[1:N],type='l',ylab=&quot;X&quot;,xlab=expression(paste(sigma,'=0.05')))</span>
<span class="co"># generated sample vs the time index when the variance of proposal distribution is 0.05</span>
<span class="co">#plot(r21[1:N],type='l',ylab=&quot;X&quot;,xlab=expression(paste(sigma,'=0.5')))</span>
<span class="co"># generated sample vs the time index when the variance of proposal distribution is 0.5</span>
 <span class="co">#abline(h=-3,col='red',lwd=.3)</span>
 <span class="co">#abline(h=3,col='red',lwd=.3)</span>
 <span class="co"># convergence range</span>
<span class="co">#plot(r31[1:N],type='l',ylab=&quot;X&quot;,xlab=expression(paste(sigma,'=2')))</span>
<span class="co"># generated sample vs the time index when the variance of proposal distribution is 4</span>
<span class="co">#abline(h=-3,col='red',lwd=.3)</span>
<span class="co">#abline(h=3,col='red',lwd=.3)</span>
<span class="co"># convergence range</span>
<span class="co">#plot(r41[1:N],type='l',ylab=&quot;X&quot;,xlab=expression(paste(sigma,'=16')))</span>
<span class="co"># generated sample vs the time index when the variance of proposal distribution is 16</span>
<span class="co">#abline(h=-3,col='red',lwd=.3)</span>
<span class="co">#abline(h=3,col='red',lwd=.3)# convergence range </span></code></pre></div>
<p>As is shown above, under the circumstances of proposal distribution with <span class="math inline">\(N\left(X_{t}, 0.05^{2}\right)\)</span>, Chain 1 has not converged to the target in 2000 iterations. The chain in second(<span class="math inline">\(\sigma=0.5\)</span>) and third(<span class="math inline">\(\sigma=2\)</span>) plot converging to the target distribution while the former requires a little longer burn-in period. Finally, in the fourth plot, where <span class="math inline">\(\sigma\)</span>= 16, most of the candidate points are rejected. The fourth chain converges, but it is inefficient.</p>
<ul>
<li><h3 id="qq-plot">QQ plot</h3></li>
</ul>
<p>We want to observe the relationship between the generated samples by the two functions in a more intuitive way. So the QQ plot and histogram of the generated sample with <span class="math inline">\(N\left(X_{t}, 0.5^{2}\right)\)</span> and <span class="math inline">\(N\left(X_{t}, 2^{2}\right)\)</span> density superimposed are shown below respectively.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#par(mfrow=c(2,2))</span>
b &lt;-<span class="st"> </span><span class="dv">201</span> ; d&lt;-<span class="dv">101</span>
<span class="co">#discard the burnin sample</span>
y1 &lt;-<span class="st"> </span>r2<span class="op">$</span>x[b<span class="op">:</span>N]
<span class="co">#y11&lt;-r21[b:N]</span>
y2 &lt;-<span class="st"> </span>r3<span class="op">$</span>x[d<span class="op">:</span>N]
<span class="co">#y21&lt;-r31[b:N]</span>
a &lt;-<span class="st"> </span><span class="kw">ppoints</span>(<span class="dv">100</span>)
<span class="co">#QR &lt;- qskewlap(1-a) </span>
<span class="co"># quantiles of Rayleigh</span>
Q1 &lt;-<span class="st"> </span><span class="kw">quantile</span>(y1, a)
<span class="co">#Q11&lt;-quantile(y11, a)</span>
Q2 &lt;-<span class="st"> </span><span class="kw">quantile</span>(y2, a)
<span class="co">#Q21&lt;-quantile(y21, a)</span>
<span class="co">#qqplot(Q1, Q11, main=&quot;&quot;,xlab=&quot;R Sample Quantiles&quot;, ylab=&quot;Rcpp Sample Quantiles&quot;)</span>
<span class="co">#hist(y11, breaks=&quot;scott&quot;, main=&quot;&quot;, xlab=&quot;&quot;, freq=FALSE)</span>
<span class="co">#lines(QR, dskewlap(QR))</span>
<span class="co">#qqplot(Q2, Q21, main=&quot;&quot;,xlab=&quot;R Sample Quantiles&quot;, ylab=&quot;Rcpp Sample Quantiles&quot;)</span>
<span class="co">#hist(y21, breaks=&quot;scott&quot;, main=&quot;&quot;, xlab=&quot;&quot;, freq=FALSE)</span>
<span class="co">#lines(QR, dskewlap(QR))</span></code></pre></div>
<ul>
<li><h3 id="time-comparision">Time Comparision</h3></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#ts &lt;- microbenchmark(MetropolisR=myrw.Metropolis(sigma[1], x0, N),</span>
<span class="co">#                     MetropolisCpp=MetropolisC(sigma[1], x0, N))</span>
<span class="co">#summary(ts)[,c(1,3,5,6)]</span></code></pre></div>
<p>We can observe that compute efficiency enjoys a marvelous improvement using the Rcpp function compared with R function, which shows the great advantage of Rcpp function.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
